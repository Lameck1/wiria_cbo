import{j as r}from"./query-vendor-DHwl1fd7.js";import{d as K,u as Q,L as T,r as n}from"./react-vendor-Bq_hyp-_.js";import{b as X,a as c,A as l}from"./index-Chx-FnBA.js";const Z=[{to:"/member-portal",label:"Dashboard",icon:"ðŸ ",exact:!0},{to:"/member-profile",label:"Profile",icon:"ðŸ‘¤"},{to:"/member-renewal",label:"Renewal",icon:"ðŸ”„"},{to:"/member-payments",label:"Payments",icon:"ðŸ’³"},{to:"/member-meetings",label:"Meetings",icon:"ðŸ“…"}];function ee(){return r.jsx("nav",{className:"bg-white rounded-xl shadow-md mb-6 overflow-x-auto",children:r.jsx("div",{className:"flex",children:Z.map(o=>r.jsxs(K,{to:o.to,end:o.exact,className:({isActive:p})=>`flex items-center gap-2 px-5 py-4 text-sm font-semibold border-b-2 whitespace-nowrap transition-colors ${p?"border-wiria-blue-dark text-wiria-blue-dark bg-wiria-blue-dark/5":"border-transparent text-gray-600 hover:text-wiria-blue-dark hover:bg-gray-50"}`,children:[r.jsx("span",{children:o.icon}),r.jsx("span",{children:o.label})]},o.to))})})}function re({children:o,title:p,subtitle:d,showNavigation:x=!0}){const{user:u,logout:y}=X(),N=Q(),g=async()=>{await y(),N("/member-login")};return r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"bg-white shadow-md sticky top-0 z-50",children:r.jsxs("nav",{className:"container mx-auto px-4 lg:px-6 py-4 flex justify-between items-center",children:[r.jsxs(T,{to:"/member-portal",className:"flex items-center gap-2",children:[r.jsx("img",{src:"/images/Wiria_CBO_Logo_NEW_IV.png",alt:"WIRIA CBO",className:"h-10"}),r.jsx("span",{className:"text-xl font-bold text-wiria-blue-dark hidden sm:block",children:"WIRIA CBO"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(T,{to:"/",className:"text-sm font-semibold text-wiria-blue-dark hover:text-wiria-yellow transition-colors",children:"ðŸ  Home"}),u&&r.jsxs("span",{className:"text-sm font-semibold text-gray-700 hidden md:block",children:[u.firstName," ",u.lastName]}),r.jsx("button",{onClick:g,className:"bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 transition-all text-sm",children:"Logout"})]})]})}),r.jsx("main",{className:"py-8",children:r.jsxs("div",{className:"container mx-auto px-4",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-wiria-blue-dark mb-1",children:p}),d&&r.jsx("p",{className:"text-gray-600",children:d})]}),x&&r.jsx(ee,{}),o]})}),r.jsx("footer",{className:"bg-wiria-blue-dark text-white py-8 mt-12",children:r.jsx("div",{className:"container mx-auto px-4 text-center",children:r.jsx("p",{children:"Â© 2025 WIRIA Community Based Organization. Confidential Member Portal."})})})]})}function ne(){const[o,p]=n.useState(null),[d,x]=n.useState([]),[u,y]=n.useState([]),[N,g]=n.useState([]),[B,j]=n.useState([]),[F,v]=n.useState([]),[V,S]=n.useState(!1),[G,P]=n.useState(null),f=n.useCallback(async()=>{var e,t,s,i,C,k,I,R,D,_;try{const a=(await c.get(l.MEMBERS_ME)).data;if(!a)return console.error("fetchProfile: Valid data not found in response"),null;const L={...a,id:a.id||"",memberNumber:a.memberNumber||"",firstName:a.firstName||((e=a.props)==null?void 0:e.firstName)||"",lastName:a.lastName||((t=a.props)==null?void 0:t.lastName)||"",email:a.email||((s=a.props)==null?void 0:s.email)||"",phone:a.phone||((i=a.props)==null?void 0:i.phone)||"",joinedAt:a.joinDate||a.joinedAt||((C=a.props)==null?void 0:C.joinDate)||"",membershipExpiresAt:a.expiryDate||a.membershipExpiresAt||((k=a.props)==null?void 0:k.expiryDate),status:a.status||"PENDING",createdAt:a.createdAt||"",membershipType:a.membershipType||((I=a.props)==null?void 0:I.membershipType),groupName:a.groupName||((R=a.props)==null?void 0:R.groupName),currentMemberCount:a.currentMemberCount||((D=a.props)==null?void 0:D.currentMemberCount),maxMemberCountReached:a.maxMemberCountReached||((_=a.props)==null?void 0:_.maxMemberCountReached)};return p(L),L}catch(A){throw console.error("Failed to fetch profile:",A),A}},[]),O=n.useCallback(async e=>{try{const s=(await c.put(l.MEMBERS_ME,e)).data,i={...s,id:s.id||"",memberNumber:s.memberNumber||"",firstName:s.firstName||"",lastName:s.lastName||"",email:s.email||"",phone:s.phone||"",status:s.status||"PENDING",createdAt:s.createdAt||"",joinedAt:s.joinDate||s.joinedAt||"",membershipExpiresAt:s.expiryDate||s.membershipExpiresAt};return p(i),i}catch(t){throw console.error("Failed to update profile:",t),t}},[]),E=n.useCallback(async()=>{var e;try{const s=((e=(await c.get(l.MEMBERS_PAYMENTS)).data)==null?void 0:e.payments)||[];return x(s),s}catch(t){return console.error("Failed to fetch payments:",t),x([]),[]}},[]),m=n.useCallback(async()=>{try{const e=await c.get(l.MEMBERS_MEETINGS),t=Array.isArray(e.data)?e.data:[];return y(t),t}catch(e){return console.error("Failed to fetch meetings:",e),y([]),[]}},[]),h=n.useCallback(async()=>{try{const e=await c.get(l.MEMBERS_MEETINGS_AVAILABLE),t=Array.isArray(e.data)?e.data:[];return g(t),t}catch(e){return console.error("Failed to fetch available meetings:",e),g([]),[]}},[]),W=n.useCallback(async e=>{try{const t=l.MEMBERS_MEETINGS_RSVP.replace(":id",e);await c.post(t,{}),await m(),await h()}catch(t){console.error("Failed to RSVP:",t)}},[m,h]),U=n.useCallback(async e=>{try{const t=l.MEMBERS_MEETINGS_RSVP.replace(":id",e);await c.delete(t),await m(),await h()}catch(t){console.error("Failed to cancel RSVP:",t)}},[m,h]),M=n.useCallback(async()=>{var e;try{const s=((e=(await c.get(l.MEMBERS_DOCUMENTS)).data)==null?void 0:e.documents)||[];return j(s),s}catch(t){return console.error("Failed to fetch documents:",t),j([]),[]}},[]),w=n.useCallback(async()=>{try{const e=await c.get(l.MEMBERS_ACTIVITY),s=(Array.isArray(e.data)?e.data:[]).map(i=>({...i,createdAt:i.timestamp||i.createdAt}));return v(s),s}catch(e){return console.error("Failed to fetch activity:",e),v([]),[]}},[]),z=n.useCallback(async()=>{S(!0),P(null);try{await Promise.all([f(),E(),m(),M(),w()])}catch{P("Failed to load member data")}finally{S(!1)}},[f,E,m,M,w]),Y=d.filter(e=>e.status==="COMPLETED").reduce((e,t)=>e+t.amount,0),$=d.filter(e=>e.status==="PENDING").length,H=(u||[]).filter(e=>e.status==="UPCOMING").length,b=o!=null&&o.membershipExpiresAt?Math.ceil((new Date(o.membershipExpiresAt).getTime()-Date.now())/(1e3*60*60*24)):null,q=b!==null&&b<=0,J=b!==null&&b>0&&b<=30;return{profile:o,payments:d,meetings:u,availableMeetings:N,documents:B,activity:F,isLoading:V,error:G,fetchProfile:f,updateProfile:O,fetchPayments:E,fetchMeetings:m,fetchAvailableMeetings:h,rsvpToMeeting:W,cancelRsvp:U,fetchDocuments:M,fetchActivity:w,fetchAll:z,totalPayments:Y,pendingPayments:$,upcomingMeetings:H,daysUntilExpiry:b,isExpired:q,isExpiringSoon:J}}export{re as P,ne as u};
//# sourceMappingURL=useMemberData-BQwxpd7I.js.map
