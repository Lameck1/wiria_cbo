{"version":3,"file":"SafeguardingManagementPage-DtSRMveu.js","sources":["../../src/features/admin/api/safeguarding.api.ts","../../src/features/admin/components/safeguarding/constants.ts","../../src/features/admin/components/safeguarding/modals/ReportDetailsModal.tsx","../../src/features/admin/components/safeguarding/modals/ResolveReportModal.tsx","../../src/features/admin/components/safeguarding/SafeguardingFilters.tsx","../../src/features/admin/components/safeguarding/SafeguardingTableColumns.tsx","../../src/pages/admin/SafeguardingManagementPage.tsx"],"sourcesContent":["/**\n * Safeguarding API Service\n * Handles safeguarding report management for admin\n */\n\nimport { apiClient } from '@/shared/services/api/client';\nimport { logger } from '@/shared/services/logger';\nimport { extractArray } from '@/shared/utils/apiUtils';\n\nexport interface SafeguardingReport {\n  id: string;\n  referenceNumber: string;\n  isAnonymous: boolean;\n  reporterName?: string;\n  reporterEmail?: string;\n  reporterPhone?: string;\n  incidentType?:\n  | 'CHILD_PROTECTION'\n  | 'SEXUAL_EXPLOITATION'\n  | 'HARASSMENT'\n  | 'DISCRIMINATION'\n  | 'FRAUD'\n  | 'OTHER';\n  category?: string;\n  incidentDate: string;\n  incidentLocation?: string;\n  location?: string;\n  description: string;\n  personsInvolved?: string;\n  witnessInfo?: string;\n  evidenceUrl?: string;\n  priority: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';\n  status: 'PENDING' | 'UNDER_REVIEW' | 'INVESTIGATING' | 'RESOLVED' | 'CLOSED';\n  assignedTo?: string;\n  resolution?: string;\n  resolvedAt?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport const getSafeguardingReports = async (params?: {\n  status?: string;\n  priority?: string;\n}): Promise<SafeguardingReport[]> => {\n  try {\n    const searchParams = new URLSearchParams();\n    if (params?.status) searchParams.append('status', params.status);\n    if (params?.priority) searchParams.append('priority', params.priority);\n    const queryString = searchParams.toString() ? `?${searchParams.toString()}` : '';\n    const response = await apiClient.get(`/safeguarding${queryString}`);\n    return extractArray<SafeguardingReport>(response);\n  } catch (error) {\n    logger.error('Failed to fetch safeguarding reports:', error);\n    throw new Error('Failed to load safeguarding reports. Please try again.');\n  }\n};\n\nexport const updateSafeguardingReport = async (\n  id: string,\n  data: Partial<SafeguardingReport>\n): Promise<boolean> => {\n  try {\n    await apiClient.patch(`/safeguarding/${id}`, data);\n    return true;\n  } catch (error) {\n    logger.error('Failed to update safeguarding report:', error);\n    throw error;\n  }\n};\n\nexport const resolveSafeguardingReport = async (\n  id: string,\n  resolution: string\n): Promise<boolean> => {\n  try {\n    await apiClient.post(`/safeguarding/${id}/resolve`, { resolution });\n    return true;\n  } catch (error) {\n    logger.error('Failed to resolve safeguarding report:', error);\n    throw error;\n  }\n};\n","export const STATUS_COLORS: Record<string, string> = {\n  PENDING: 'bg-yellow-100 text-yellow-700',\n  UNDER_REVIEW: 'bg-blue-100 text-blue-700',\n  INVESTIGATING: 'bg-orange-100 text-orange-700',\n  RESOLVED: 'bg-green-100 text-green-700',\n  CLOSED: 'bg-gray-100 text-gray-500',\n};\n\nexport const PRIORITY_COLORS: Record<string, string> = {\n  CRITICAL: 'bg-red-600 text-white',\n  HIGH: 'bg-orange-500 text-white',\n  MEDIUM: 'bg-yellow-500 text-white',\n  LOW: 'bg-green-500 text-white',\n};\n\nexport const INCIDENT_TYPES: Record<string, string> = {\n  CHILD_PROTECTION: 'Child Protection',\n  SEXUAL_EXPLOITATION: 'Sexual Exploitation',\n  HARASSMENT: 'Harassment',\n  DISCRIMINATION: 'Discrimination',\n  FRAUD: 'Fraud',\n  OTHER: 'Other',\n};\n","import type { SafeguardingReport } from '@/features/admin/api/safeguarding.api';\nimport { Button } from '@/shared/components/ui/Button';\n\ninterface ReportDetailsModalProps {\n  report: SafeguardingReport;\n  statusColors: Record<string, string>;\n  priorityColors: Record<string, string>;\n  incidentTypes: Record<string, string>;\n  onClose: () => void;\n  onResolve: () => void;\n  onStatusChange: (status: SafeguardingReport['status']) => void;\n}\n\nconst formatDate = (date: string) =>\n  new Date(date).toLocaleDateString('en-KE', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n  });\n\nexport function ReportDetailsModal({\n  report,\n  statusColors,\n  priorityColors,\n  incidentTypes,\n  onClose,\n  onResolve,\n  onStatusChange,\n}: ReportDetailsModalProps) {\n  const incidentKey = report.incidentType ?? report.category;\n  const incidentLabel =\n    incidentKey === undefined ? undefined : incidentTypes[incidentKey] ?? incidentKey;\n\n  return (\n    <div className=\"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 p-4\">\n      <div className=\"flex max-h-[90vh] w-full max-w-3xl flex-col rounded-2xl bg-white shadow-2xl\">\n        <div className=\"flex items-center justify-between border-b p-6\">\n          <div>\n            <h3 className=\"font-mono text-xl font-bold\">Report: {report.referenceNumber}</h3>\n            <div className=\"mt-1 flex gap-2\">\n              <span\n                className={`rounded px-2 py-0.5 text-[10px] font-bold uppercase ${priorityColors[report.priority]}`}\n              >\n                {report.priority}\n              </span>\n              <span\n                className={`rounded-full px-2 py-0.5 text-[10px] font-bold uppercase ${statusColors[report.status]}`}\n              >\n                {report.status.replace('_', ' ')}\n              </span>\n            </div>\n          </div>\n          <button onClick={onClose} className=\"text-2xl text-gray-500 hover:text-gray-700\">\n            &times;\n          </button>\n        </div>\n        <div className=\"flex-1 space-y-6 overflow-y-auto p-6\">\n          <div className=\"grid grid-cols-1 gap-6 md:grid-cols-2\">\n            <InfoItem label=\"Incident Type\" value={incidentLabel} />\n            <InfoItem label=\"Incident Date\" value={formatDate(report.incidentDate)} />\n            <InfoItem\n              label=\"Location\"\n              value={report.incidentLocation ?? report.location}\n            />\n            <InfoItem label=\"Reported On\" value={formatDate(report.createdAt)} />\n            {!report.isAnonymous && (\n              <>\n                <InfoItem label=\"Reporter Name\" value={report.reporterName} />\n                <InfoItem\n                  label=\"Reporter Contact\"\n                  value={report.reporterEmail ?? report.reporterPhone ?? 'N/A'}\n                />\n              </>\n            )}\n          </div>\n          <div>\n            <p className=\"mb-2 text-[10px] font-bold uppercase tracking-widest text-gray-400\">\n              Description\n            </p>\n            <div className=\"whitespace-pre-wrap rounded-xl border border-gray-100 bg-gray-50 p-4 leading-relaxed text-gray-700\">\n              {report.description}\n            </div>\n          </div>\n          {report.personsInvolved && (\n            <div>\n              <p className=\"mb-2 text-[10px] font-bold uppercase tracking-widest text-gray-400\">\n                Persons Involved\n              </p>\n              <div className=\"rounded-xl border border-gray-100 bg-gray-50 p-4 text-gray-700\">\n                {report.personsInvolved}\n              </div>\n            </div>\n          )}\n          {report.resolution && (\n            <div>\n              <p className=\"mb-2 text-[10px] font-bold uppercase tracking-widest text-green-600\">\n                Final Resolution\n              </p>\n              <div className=\"rounded-xl border border-green-100 bg-green-50 p-4 font-medium text-green-800\">\n                {report.resolution}\n              </div>\n            </div>\n          )}\n\n          {/* Status Update */}\n          {report.status !== 'RESOLVED' && report.status !== 'CLOSED' && (\n            <div>\n              <p className=\"mb-3 text-[10px] font-bold uppercase tracking-widest text-gray-400\">\n                Update Status\n              </p>\n              <div className=\"flex flex-wrap gap-2\">\n                {(\n                  ['PENDING', 'UNDER_REVIEW', 'INVESTIGATING'] as SafeguardingReport['status'][]\n                ).map((status) => (\n                  <button\n                    key={status}\n                    onClick={() => onStatusChange(status)}\n                    className={`rounded-lg px-4 py-1.5 text-xs font-bold shadow-sm transition-all ${report.status === status ? statusColors[status] : 'border border-gray-200 bg-white text-gray-500 hover:bg-gray-50'}`}\n                  >\n                    {status.replace('_', ' ')}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n        <div className=\"flex gap-3 border-t p-6\">\n          {report.status !== 'RESOLVED' && report.status !== 'CLOSED' && (\n            <Button onClick={onResolve}>Mark as Resolved</Button>\n          )}\n          <Button variant=\"secondary\" onClick={onClose} className=\"ml-auto\">\n            Close\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction InfoItem({ label, value }: { label: string; value: string | undefined }) {\n  return (\n    <div className=\"space-y-1\">\n      <p className=\"text-[10px] font-bold uppercase tracking-widest text-gray-400\">{label}</p>\n      <p className=\"font-semibold text-gray-900\">{value ?? 'N/A'}</p>\n    </div>\n  );\n}\n","import type { SafeguardingReport } from '@/features/admin/api/safeguarding.api';\nimport { Button } from '@/shared/components/ui/Button';\n\ninterface ResolveReportModalProps {\n  report: SafeguardingReport;\n  resolution: string;\n  isSubmitting: boolean;\n  setResolution: (value: string) => void;\n  onResolve: () => void;\n  onCancel: () => void;\n}\n\nexport function ResolveReportModal({\n  report,\n  resolution,\n  isSubmitting,\n  setResolution,\n  onResolve,\n  onCancel,\n}: ResolveReportModalProps) {\n  return (\n    <div className=\"fixed inset-0 z-[70] flex items-center justify-center bg-black bg-opacity-50 p-4\">\n      <div className=\"w-full max-w-lg rounded-2xl bg-white shadow-2xl\">\n        <div className=\"border-b p-6\">\n          <h3 className=\"text-xl font-bold\">Resolve Report</h3>\n          <p className=\"mt-1 font-mono text-sm text-gray-500\">Ref: {report.referenceNumber}</p>\n        </div>\n        <div className=\"p-6\">\n          <label\n            htmlFor=\"resolution-details\"\n            className=\"mb-2 block text-sm font-bold text-gray-700\"\n          >\n            Resolution Details *\n          </label>\n          <textarea\n            id=\"resolution-details\"\n            value={resolution}\n            onChange={(event) => setResolution(event.target.value)}\n            className=\"h-40 w-full rounded-xl border border-gray-200 p-4 outline-none transition-all focus:ring-2 focus:ring-wiria-blue-dark\"\n            placeholder=\"Please describe how this concern was investigated and resolved in detail...\"\n            required\n          />\n          <p className=\"mt-2 text-[10px] font-medium italic text-gray-400\">\n            This resolution will be permanently stored and used for audit purposes.\n          </p>\n        </div>\n        <div className=\"flex gap-3 border-t p-6\">\n          <Button\n            onClick={onResolve}\n            disabled={isSubmitting || !resolution.trim()}\n            className=\"flex-1\"\n          >\n            {isSubmitting ? 'Saving Resolution...' : 'Confirm Resolution'}\n          </Button>\n          <Button variant=\"secondary\" onClick={onCancel} disabled={isSubmitting}>\n            Cancel\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","interface SafeguardingFiltersProps {\n  statusFilter: string;\n  setStatusFilter: (value: string) => void;\n  priorityFilter: string;\n  setPriorityFilter: (value: string) => void;\n}\n\nexport function SafeguardingFilters({\n  statusFilter,\n  setStatusFilter,\n  priorityFilter,\n  setPriorityFilter,\n}: SafeguardingFiltersProps) {\n  return (\n    <div className=\"flex flex-wrap items-center gap-4 rounded-xl border border-gray-100 bg-white p-4 shadow-sm\">\n      <span className=\"px-2 text-xs font-bold uppercase tracking-widest text-gray-400\">\n        Filters:\n      </span>\n      <select\n        value={statusFilter}\n        onChange={(event) => setStatusFilter(event.target.value)}\n        className=\"rounded-lg border-none bg-gray-50 px-4 py-2 text-sm font-medium outline-none transition-all focus:ring-2 focus:ring-wiria-blue-dark\"\n        aria-label=\"Filter by Status\"\n      >\n        <option value=\"\">All Statuses</option>\n        <option value=\"PENDING\">Pending</option>\n        <option value=\"UNDER_REVIEW\">Under Review</option>\n        <option value=\"INVESTIGATING\">Investigating</option>\n        <option value=\"RESOLVED\">Resolved</option>\n        <option value=\"CLOSED\">Closed</option>\n      </select>\n      <select\n        value={priorityFilter}\n        onChange={(event) => setPriorityFilter(event.target.value)}\n        className=\"rounded-lg border-none bg-gray-50 px-4 py-2 text-sm font-medium outline-none transition-all focus:ring-2 focus:ring-wiria-blue-dark\"\n        aria-label=\"Filter by Priority\"\n      >\n        <option value=\"\">All Priorities</option>\n        <option value=\"CRITICAL\">Critical</option>\n        <option value=\"HIGH\">High</option>\n        <option value=\"MEDIUM\">Medium</option>\n        <option value=\"LOW\">Low</option>\n      </select>\n    </div>\n  );\n}\n","import type { SafeguardingReport } from '@/features/admin/api/safeguarding.api';\nimport type { Column } from '@/shared/components/ui/DataTable';\nimport { StatusBadge } from '@/shared/components/ui/StatusBadge';\nimport { formatDate } from '@/shared/utils/helpers';\n\nimport { INCIDENT_TYPES, PRIORITY_COLORS } from './constants';\n\nexport const getSafeguardingColumns = (\n  onView: (report: SafeguardingReport) => void,\n  onResolve: (report: SafeguardingReport) => void\n): Column<SafeguardingReport>[] => [\n  { header: 'Reference', key: 'referenceNumber', className: 'font-mono text-xs font-bold' },\n  {\n    header: 'Type',\n    key: 'incidentType',\n    render: (r) => {\n      const typeKey = r.incidentType ?? r.category;\n      const label = typeKey ? INCIDENT_TYPES[typeKey] ?? typeKey : 'N/A';\n      return <span className=\"text-sm\">{label}</span>;\n    },\n  },\n  {\n    header: 'Priority',\n    key: 'priority',\n    render: (r) => (\n      <span\n        className={`rounded px-2 py-0.5 text-[10px] font-bold uppercase ${PRIORITY_COLORS[r.priority]}`}\n      >\n        {r.priority}\n      </span>\n    ),\n  },\n  {\n    header: 'Status',\n    key: 'status',\n    render: (r) => <StatusBadge status={r.status} />,\n  },\n  {\n    header: 'Date',\n    key: 'createdAt',\n    render: (r) => <span className=\"text-sm text-gray-500\">{formatDate(r.createdAt)}</span>,\n  },\n  {\n    header: 'Actions',\n    key: 'actions',\n    align: 'right',\n    render: (r) => (\n      <div className=\"flex justify-end gap-3\">\n        <button\n          onClick={() => onView(r)}\n          className=\"text-sm font-bold text-wiria-blue-dark hover:underline\"\n        >\n          View\n        </button>\n        {r.status !== 'RESOLVED' && r.status !== 'CLOSED' && (\n          <button\n            onClick={() => onResolve(r)}\n            className=\"text-sm font-bold text-green-600 hover:underline\"\n          >\n            Resolve\n          </button>\n        )}\n      </div>\n    ),\n  },\n];\n","import { useMemo, useState } from 'react';\n\nimport { useQueryClient } from '@tanstack/react-query';\n\nimport type { SafeguardingReport } from '@/features/admin/api/safeguarding.api';\nimport {\n  getSafeguardingReports,\n  resolveSafeguardingReport as resolveReport,\n  updateSafeguardingReport as updateReport,\n} from '@/features/admin/api/safeguarding.api';\nimport { AdminPageHeader } from '@/features/admin/components/layout/AdminPageHeader';\nimport {\n  INCIDENT_TYPES,\n  PRIORITY_COLORS,\n  STATUS_COLORS,\n} from '@/features/admin/components/safeguarding/constants';\nimport { ReportDetailsModal } from '@/features/admin/components/safeguarding/modals/ReportDetailsModal';\nimport { ResolveReportModal } from '@/features/admin/components/safeguarding/modals/ResolveReportModal';\nimport { SafeguardingFilters } from '@/features/admin/components/safeguarding/SafeguardingFilters';\nimport { getSafeguardingColumns } from '@/features/admin/components/safeguarding/SafeguardingTableColumns';\nimport { ADMIN_KEYS } from '@/features/admin/hooks/useNotificationQueries';\nimport { DataTable } from '@/shared/components/ui/DataTable';\nimport { TIMING } from '@/shared/constants/config';\nimport { useAdminAction, useAdminData } from '@/shared/hooks/useAdminData';\nimport { notificationService } from '@/shared/services/notification/notificationService';\n\nexport default function SafeguardingManagementPage() {\n  const queryClient = useQueryClient();\n  const [statusFilter, setStatusFilter] = useState('');\n  const [priorityFilter, setPriorityFilter] = useState('');\n\n  const queryParams = {\n    ...(statusFilter && { status: statusFilter }),\n    ...(priorityFilter && { priority: priorityFilter }),\n  };\n\n  const { items: reports, isLoading } = useAdminData<SafeguardingReport>(\n    ['safeguarding', queryParams],\n    () => getSafeguardingReports(Object.keys(queryParams).length > 0 ? queryParams : undefined),\n    { staleTime: TIMING.POLLING_INTERVAL }\n  );\n\n  const updateStatusAction = useAdminAction(\n    ({ id, status }: { id: string; status: SafeguardingReport['status'] }) =>\n      updateReport(id, { status }),\n    [['safeguarding']],\n    {\n      onSuccess: () => {\n        notificationService.success('Report status updated');\n        void queryClient.invalidateQueries({ queryKey: ADMIN_KEYS.notifications });\n      },\n      onError: () => {\n        notificationService.error('Failed to update report status');\n      },\n    }\n  );\n\n  const resolveAction = useAdminAction(\n    ({ id, resolution }: { id: string; resolution: string }) => resolveReport(id, resolution),\n    [['safeguarding']],\n    {\n      onSuccess: () => {\n        notificationService.success('Report resolved successfully');\n        void queryClient.invalidateQueries({ queryKey: ADMIN_KEYS.notifications });\n      },\n      onError: () => {\n        notificationService.error('Failed to resolve report');\n      },\n    }\n  );\n\n  const [selectedReportId, setSelectedReportId] = useState<string | null>(null);\n  const [showResolveModal, setShowResolveModal] = useState(false);\n  const [resolution, setResolution] = useState('');\n\n  const selectedReport: SafeguardingReport | null = useMemo(\n    () => reports.find((report) => report.id === selectedReportId) ?? null,\n    [reports, selectedReportId]\n  );\n\n  const handleResolve = () => {\n    if (!selectedReport || !resolution.trim()) return;\n    resolveAction.mutate(\n      { id: selectedReport.id, resolution },\n      {\n        onSuccess: () => {\n          setShowResolveModal(false);\n          setResolution('');\n          setSelectedReportId(null);\n        },\n      }\n    );\n  };\n\n  const columns = getSafeguardingColumns(\n    (r) => setSelectedReportId(r.id),\n    (r) => {\n      setSelectedReportId(r.id);\n      setShowResolveModal(true);\n    }\n  );\n\n  const criticalCount = reports.filter(\n    (r) => r.priority === 'CRITICAL' && r.status !== 'RESOLVED' && r.status !== 'CLOSED'\n  ).length;\n  const openCount = reports.filter((r) => r.status !== 'RESOLVED' && r.status !== 'CLOSED').length;\n\n  return (\n    <div className=\"space-y-8\">\n      <AdminPageHeader\n        title=\"Safeguarding Reports\"\n        description=\"Manage and respond to safeguarding concerns within the community.\"\n      >\n        <div className=\"flex gap-3\">\n          {criticalCount > 0 && (\n            <div className=\"flex animate-pulse items-center gap-2 rounded-xl border border-red-100 bg-red-50 px-4 py-2 shadow-sm\">\n              <span className=\"h-2 w-2 rounded-full bg-red-600\" />\n              <span className=\"text-sm font-bold text-red-700\">{criticalCount} critical</span>\n            </div>\n          )}\n          {openCount > 0 && (\n            <div className=\"flex items-center gap-2 rounded-xl border border-yellow-100 bg-yellow-50 px-4 py-2 shadow-sm\">\n              <span className=\"h-2 w-2 rounded-full bg-yellow-600\" />\n              <span className=\"text-sm font-bold text-yellow-700\">\n                {openCount} active case{openCount > 1 ? 's' : ''}\n              </span>\n            </div>\n          )}\n        </div>\n      </AdminPageHeader>\n\n      <SafeguardingFilters\n        statusFilter={statusFilter}\n        setStatusFilter={setStatusFilter}\n        priorityFilter={priorityFilter}\n        setPriorityFilter={setPriorityFilter}\n      />\n\n      <DataTable\n        columns={columns}\n        data={reports}\n        rowKey=\"id\"\n        isLoading={isLoading}\n        emptyMessage=\"No safeguarding reports found matching your criteria.\"\n        rowClassName={(r) => (r.priority === 'CRITICAL' ? 'bg-red-50/50 hover:bg-red-50' : '')}\n      />\n\n      {selectedReport && !showResolveModal && (\n        <ReportDetailsModal\n          report={selectedReport}\n          statusColors={STATUS_COLORS}\n          priorityColors={PRIORITY_COLORS}\n          incidentTypes={INCIDENT_TYPES}\n          onClose={() => setSelectedReportId(null)}\n          onResolve={() => setShowResolveModal(true)}\n          onStatusChange={(status) => {\n            if (!selectedReport) return;\n            queryClient.setQueriesData<SafeguardingReport[]>(\n              { queryKey: ['safeguarding'] },\n              (old) =>\n                (old ?? []).map((report) =>\n                  report.id === selectedReport.id ? { ...report, status } : report\n                )\n            );\n            updateStatusAction.mutate({ id: selectedReport.id, status });\n          }}\n        />\n      )}\n\n      {showResolveModal && selectedReport && (\n        <ResolveReportModal\n          report={selectedReport}\n          resolution={resolution}\n          isSubmitting={resolveAction.isPending}\n          setResolution={setResolution}\n          onResolve={handleResolve}\n          onCancel={() => {\n            setShowResolveModal(false);\n            setResolution('');\n          }}\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["getSafeguardingReports","params","searchParams","queryString","response","apiClient","extractArray","error","logger","updateSafeguardingReport","id","data","resolveSafeguardingReport","resolution","STATUS_COLORS","PRIORITY_COLORS","INCIDENT_TYPES","formatDate","date","ReportDetailsModal","report","statusColors","priorityColors","incidentTypes","onClose","onResolve","onStatusChange","incidentKey","incidentLabel","jsxs","jsx","InfoItem","Fragment","status","Button","label","value","ResolveReportModal","isSubmitting","setResolution","onCancel","event","SafeguardingFilters","statusFilter","setStatusFilter","priorityFilter","setPriorityFilter","getSafeguardingColumns","onView","r","typeKey","StatusBadge","SafeguardingManagementPage","queryClient","useQueryClient","useState","queryParams","reports","isLoading","useAdminData","TIMING","updateStatusAction","useAdminAction","updateReport","notificationService","ADMIN_KEYS","resolveAction","resolveReport","selectedReportId","setSelectedReportId","showResolveModal","setShowResolveModal","selectedReport","useMemo","handleResolve","columns","criticalCount","openCount","AdminPageHeader","DataTable","old"],"mappings":"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"}