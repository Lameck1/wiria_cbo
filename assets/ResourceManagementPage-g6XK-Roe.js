import{d as f,a as x,j as e,u as h,e as g}from"./query-vendor-DeB3i2OK.js";import{u as j,a as N,c as w,d as R,g as S}from"./resources.api-tVkFgTyM.js";import{F as v}from"./FormModal-Dn2Mmtft.js";import{n as d}from"./index-YnLEVKPI.js";import{g as C,a as F}from"./apiUtils-CDDJc0SC.js";import{C as P}from"./ConfirmDialog-DcyEGIWl.js";import{B as T}from"./Button-jhyg_cfE.js";import"./Input-BK6NcICT.js";import"./helpers-C-aBis0i.js";import"./Modal-DSDFZpMT.js";import"./animation-vendor-JsFu8W7l.js";import"./Select-ViCfK5u5.js";import"./Textarea-CHdiKLHU.js";import"./react-vendor-D3fc32Hw.js";const k=["GOVERNANCE","STRATEGIC","FINANCIAL","REPORTS","POLICIES","PUBLICATIONS","OTHER"];function E(l){const{selectedFile:r,resource:o}=l;return[{name:"title",label:"Title",type:"text",required:!0,placeholder:"e.g. Annual Strategic Report 2024"},{name:"category",label:"Category",type:"select",required:!0,options:k.map(n=>({value:n,label:n}))},{name:"fileType",label:"File Type",type:"text",placeholder:"Automatically detected from file",defaultValue:r?r.name.split(".").pop()?.toUpperCase()??"FILE":o?.fileType??"PDF"},{name:"fileSize",label:"File Size",type:"text",placeholder:"Auto-filled from upload",defaultValue:r?`${(r.size/(1024*1024)).toFixed(2)} MB`:o?.fileSize??""},{name:"isPublic",label:"Visibility",type:"select",required:!0,options:[{value:"true",label:"Public"},{value:"false",label:"Private (Internal Only)"}],defaultValue:o?.isPublic===!1?"false":"true"},{name:"downloadUrl",label:"Download URL",type:"text",placeholder:"Or provide direct URL"},{name:"description",label:"Description",type:"textarea",required:!0,rows:3},{name:"summary",label:"Summary",type:"textarea",rows:4},{name:"keyPoints",label:"Key Points (comma separated)",type:"text",placeholder:"e.g. Governance, Transparency, Impact"}]}function A({resource:l,onClose:r,onSuccess:o}){const n=f(),[i,c]=x.useState(null),u=t=>{const a=t.target.files?.[0];c(a??null)},p=async t=>{let a=t.downloadUrl||"";i&&(d.info("Uploading file..."),a=(await j(i,"resources")).data.url,t.fileSize??=`${(i.size/(1024*1024)).toFixed(2)} MB`,t.fileType??=i.name.split(".").pop()?.toUpperCase()??"FILE");const s={title:t.title||"",category:t.category||"",fileType:t.fileType||"",fileSize:t.fileSize||"",description:t.description||"",summary:t.summary,downloadUrl:a,isPublic:t.isPublic==="true",keyPoints:t.keyPoints?t.keyPoints.split(",").map(m=>m.trim()).filter(m=>m!==""):[]};l?(await N(l.id,s),d.success("Resource updated successfully")):(await w(s),d.success("Resource added successfully")),n.invalidateQueries({queryKey:["admin","resources"]}),o()},y=async t=>{try{await p(t)}catch(a){throw d.error(C(a,"Operation failed")),a}},b=E({selectedFile:i,resource:l});return e.jsx(v,{isOpen:!0,onClose:r,onSubmit:y,title:l?"Edit Resource":"Add New Resource",fields:b,initialData:l?{...l}:void 0,submitLabel:"Save Resource",children:e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-bold",htmlFor:"resource-file-input",children:"Resource File"}),e.jsx("input",{type:"file",id:"resource-file-input",onChange:u,className:"w-full rounded-lg border p-2.5 text-sm",accept:".pdf,.doc,.docx,.xls,.xlsx"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Maximum size: 10MB. File type and size will be detected automatically."})]})})}function H(){const l=f(),[r,o]=x.useState(null),[n,i]=x.useState(!1),[c,u]=x.useState(null),{data:p=[],isLoading:y}=h({queryKey:["admin","resources"],queryFn:async()=>{const s=await S();return F(s)}}),b=g({mutationFn:R,onSuccess:()=>{d.success("Resource deleted successfully"),l.invalidateQueries({queryKey:["admin","resources"]})},onError:()=>{d.error("Failed to delete resource")}}),t=s=>{u(s)},a=()=>{c&&(b.mutate(c),u(null))};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-wiria-blue-dark",children:"Resource Management"}),e.jsx(T,{onClick:()=>{o(null),i(!0)},children:"+ Add New Resource"})]}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-white shadow",children:y?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx("div",{className:"mx-auto mb-2 h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-wiria-blue-dark"}),"Loading resources..."]}):e.jsxs("table",{className:"w-full border-collapse text-left",children:[e.jsx("thead",{className:"border-b bg-gray-50 text-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-semibold uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-4 font-semibold uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-4 font-semibold uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-4 font-semibold uppercase tracking-wider",children:"Public"}),e.jsx("th",{className:"px-6 py-4 font-semibold uppercase tracking-wider",children:"Downloads"}),e.jsx("th",{className:"px-6 py-4 text-right font-semibold uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y text-slate-600",children:[p.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-slate-900",children:s.title}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"rounded bg-blue-50 px-2.5 py-1 text-xs font-bold uppercase text-blue-700",children:s.category})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium",children:[s.fileType," (",s.fileSize,")"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`rounded-full px-2.5 py-0.5 text-xs font-bold ${s.isPublic?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.isPublic?"Yes":"No"})}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:s.downloads||0}),e.jsxs("td",{className:"px-6 py-4 text-right",children:[e.jsx("button",{onClick:()=>{o(s),i(!0)},className:"mr-4 text-sm font-bold text-wiria-blue-dark transition-colors hover:text-blue-800",children:"Edit"}),e.jsx("button",{onClick:()=>{t(s.id)},className:"text-sm font-bold text-red-600 transition-colors hover:text-red-800",children:"Delete"})]})]},s.id)),p.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx("div",{className:"mb-2 text-4xl opacity-20",children:"ðŸ“"}),"No resources available."]})})]})]})}),n&&e.jsx(A,{resource:r,onClose:()=>i(!1),onSuccess:()=>i(!1)}),e.jsx(P,{isOpen:c!==null,title:"Delete Resource",message:"Are you sure you want to delete this resource?",confirmLabel:"Delete",onConfirm:a,onCancel:()=>u(null)})]})}export{H as default};
//# sourceMappingURL=ResourceManagementPage-g6XK-Roe.js.map
