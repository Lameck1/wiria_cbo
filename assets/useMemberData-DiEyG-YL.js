import{j as r,u as d,d as h,e as M,a as b}from"./query-vendor-DeB3i2OK.js";import{b as R,u as C,L as N}from"./react-vendor-D3fc32Hw.js";import{u as I,b as c}from"./index-YnLEVKPI.js";import{A as l}from"./endpoints-Cofiu-EW.js";const S=[{to:"/member-portal",label:"Dashboard",icon:"ðŸ ",exact:!0},{to:"/member-profile",label:"Profile",icon:"ðŸ‘¤"},{to:"/member-renewal",label:"Renewal",icon:"ðŸ”„"},{to:"/member-payments",label:"Payments",icon:"ðŸ’³"},{to:"/member-meetings",label:"Meetings",icon:"ðŸ“…"}];function T(){return r.jsx("nav",{className:"mb-6 overflow-x-auto rounded-xl bg-white shadow-md","aria-label":"Member Portal Navigation",children:r.jsx("div",{className:"flex",children:S.map(e=>r.jsxs(R,{to:e.to,end:e.exact,className:({isActive:t})=>`flex items-center gap-2 whitespace-nowrap border-b-2 px-5 py-4 text-sm font-semibold transition-colors ${t?"border-wiria-blue-dark bg-wiria-blue-dark/5 text-wiria-blue-dark":"border-transparent text-gray-600 hover:bg-gray-50 hover:text-wiria-blue-dark"}`,children:[r.jsx("span",{children:e.icon}),r.jsx("span",{children:e.label})]},e.to))})})}function te({children:e,title:t,subtitle:n,showNavigation:i=!0}){const{user:u,logout:m}=I(),s=C(),y=async()=>{await m(),s("/member-login")};return r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"sticky top-0 z-50 bg-white shadow-md",children:r.jsxs("nav",{className:"container mx-auto flex items-center justify-between px-4 py-4 lg:px-6",children:[r.jsxs(N,{to:"/member-portal",className:"flex items-center gap-2",children:[r.jsx("img",{src:"/images/Wiria_CBO_Logo_NEW_IV.png",alt:"WIRIA CBO",className:"h-10"}),r.jsx("span",{className:"hidden text-xl font-bold text-wiria-blue-dark sm:block",children:"WIRIA CBO"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(N,{to:"/",className:"text-sm font-semibold text-wiria-blue-dark transition-colors hover:text-wiria-yellow",children:"ðŸ  Home"}),u&&r.jsxs("span",{className:"hidden text-sm font-semibold text-gray-700 md:block",children:[u.firstName," ",u.lastName]}),r.jsx("button",{onClick:()=>{y()},className:"rounded-lg bg-gray-200 px-4 py-2 text-sm font-bold text-gray-700 transition-all hover:bg-gray-300",children:"Logout"})]})]})}),r.jsx("main",{className:"py-8",children:r.jsxs("div",{className:"container mx-auto px-4",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"mb-1 text-3xl font-bold text-wiria-blue-dark",children:t}),n&&r.jsx("p",{className:"text-gray-600",children:n})]}),i&&r.jsx(T,{}),e]})}),r.jsx("footer",{className:"mt-12 bg-wiria-blue-dark py-8 text-white",children:r.jsx("div",{className:"container mx-auto px-4 text-center",children:r.jsx("p",{children:"Â© 2025 WIRIA Community Based Organization. Confidential Member Portal."})})})]})}function g(e,t){if(Array.isArray(e))return e;for(const n of t){const i=e[n];if(Array.isArray(i))return i}return[]}function q(e){return{id:e.id??"",amount:Number(e.amount)??0,type:e.type??"DONATION",status:e.status??"PENDING",method:e.method??"MANUAL",mpesaReceiptNumber:e.mpesaReceiptNumber,createdAt:e.createdAt??""}}function _(e){return{id:e.id??"",title:e.title??"",description:e.description,date:e.date??"",time:e.time??"",location:e.location??"",type:e.type??"AGM",status:e.status??"UPCOMING",isRsvpd:e.isRsvpd,attendeesCount:e.attendeesCount}}function L(e){return{id:e.id??"",type:e.type??"",description:e.description??"",createdAt:e.timestamp??e.createdAt??""}}const p={profile(e){if(!e)throw new Error("Member adapter error: No profile data provided");const t=e.props??e;return{...k(e,t),...B(t),...Q(t),...F(e,t),...K(e,t)}},payments(e){return g(e,["payments"]).map(n=>q(n))},meetings(e){return g(e,["data"]).map(n=>_(n))},activity(e){return g(e,["data"]).map(n=>L(n))}};function k(e,t){return{id:e.id??t.id??"",memberNumber:e.memberNumber??t.memberNumber??"",firstName:t.firstName??"",lastName:t.lastName??""}}function B(e){return{email:e.email??"",phone:e.phone??"",nationalId:e.nationalId,occupation:e.occupation,address:e.address,county:e.county,subcounty:e.subcounty,ward:e.ward}}function Q(e){return{interests:e.interests??[],skills:e.skills??[]}}function F(e,t){return{status:e.status??t.status??"PENDING",membershipType:e.membershipType??t.membershipType,groupName:e.groupName??t.groupName,currentMemberCount:e.currentMemberCount??t.currentMemberCount,maxMemberCountReached:e.maxMemberCountReached??t.maxMemberCountReached}}function K(e,t){return{joinedAt:e.joinDate??e.joinedAt??t.joinDate??t.joinedAt??"",membershipExpiresAt:e.expiryDate??e.membershipExpiresAt??t.expiryDate??t.membershipExpiresAt,createdAt:e.createdAt??t.createdAt??""}}const a={all:["member"],profile:()=>[...a.all,"profile"],payments:()=>[...a.all,"payments"],meetings:e=>[...a.all,"meetings",e],documents:()=>[...a.all,"documents"],activity:()=>[...a.all,"activity"]};function O(){return d({queryKey:a.profile(),queryFn:async()=>{const e=await c.get(l.MEMBERS_ME);return p.profile(e.data)},staleTime:1e3*60*5})}function G(){const e=h();return M({mutationFn:async t=>{const n=await c.put(l.MEMBERS_ME,t);return p.profile(n.data)},onSuccess:t=>{e.setQueryData(a.profile(),t)}})}function U(){return d({queryKey:a.payments(),queryFn:async()=>{const e=await c.get(l.MEMBERS_PAYMENTS);return p.payments(e.data)},staleTime:1e3*60*5})}function V(){return d({queryKey:a.meetings("joined"),queryFn:async()=>{const e=await c.get(l.MEMBERS_MEETINGS);return p.meetings(e.data)},staleTime:1e3*60*5})}function W(){return d({queryKey:a.meetings("available"),queryFn:async()=>{const e=await c.get(l.MEMBERS_MEETINGS_AVAILABLE);return p.meetings(e.data)},staleTime:1e3*60*5})}function D(){return d({queryKey:a.documents(),queryFn:async()=>((await c.get(l.MEMBERS_DOCUMENTS)).data?.documents??[]).map(n=>({id:n.id??"",name:n.name??"",type:n.type??"",url:n.url??"",createdAt:n.createdAt??""})),staleTime:1e3*60*10})}function Y(){return d({queryKey:a.activity(),queryFn:async()=>{const e=await c.get(l.MEMBERS_ACTIVITY);return p.activity(e.data)},staleTime:1e3*60*2})}function z(){const e=h();return M({mutationFn:async t=>{const n=l.MEMBERS_MEETINGS_RSVP.replace(":id",t);return c.post(n,{})},onSuccess:()=>{e.invalidateQueries({queryKey:a.meetings("joined")}),e.invalidateQueries({queryKey:a.meetings("available")})}})}function $(){const e=h();return M({mutationFn:async t=>{const n=l.MEMBERS_MEETINGS_RSVP.replace(":id",t);return c.delete(n)},onSuccess:()=>{e.invalidateQueries({queryKey:a.meetings("joined")}),e.invalidateQueries({queryKey:a.meetings("available")})}})}function H(e,t,n){const i=b.useMemo(()=>(t.data??[]).filter(o=>o.status==="COMPLETED").reduce((o,x)=>o+x.amount,0),[t.data]),u=b.useMemo(()=>(t.data??[]).filter(o=>o.status==="PENDING").length,[t.data]),m=b.useMemo(()=>(n.data??[]).filter(o=>o.status==="UPCOMING").length,[n.data]),s=b.useMemo(()=>{const o=e.data?.membershipExpiresAt;return o?Math.ceil((new Date(o).getTime()-Date.now())/(1e3*60*60*24)):null},[e.data?.membershipExpiresAt]),y=s!==null&&s<=0,f=s!==null&&s>0&&s<=30;return{totalPayments:i,pendingPayments:u,upcomingMeetings:m,daysUntilExpiry:s,isExpired:y,isExpiringSoon:f}}function ne(){const e=O(),t=G(),n=U(),i=V(),u=W(),m=D(),s=Y(),y=z(),f=$(),{totalPayments:o,pendingPayments:x,upcomingMeetings:E,daysUntilExpiry:v,isExpired:A,isExpiringSoon:w}=H(e,n,i),j=e.isLoading||n.isLoading||i.isLoading||m.isLoading||s.isLoading,P=e.error?.message??n.error?.message??null;return{profile:e.data??null,payments:n.data??[],meetings:i.data??[],availableMeetings:u.data??[],documents:m.data??[],activity:s.data??[],isLoading:j,error:P,fetchProfile:e.refetch,updateProfile:t.mutateAsync,fetchPayments:n.refetch,fetchMeetings:i.refetch,fetchAvailableMeetings:u.refetch,rsvpToMeeting:y.mutateAsync,cancelRsvp:f.mutateAsync,fetchDocuments:m.refetch,fetchActivity:s.refetch,fetchAll:async()=>{await Promise.all([e.refetch(),n.refetch(),i.refetch(),m.refetch(),s.refetch()])},totalPayments:o,pendingPayments:x,upcomingMeetings:E,daysUntilExpiry:v,isExpired:A,isExpiringSoon:w}}export{te as P,ne as u};
//# sourceMappingURL=useMemberData-DiEyG-YL.js.map
