import{j as e}from"./query-vendor-DD8i-cqI.js";import{h as I,u as L,r as a,L as C}from"./react-vendor-CPrm261X.js";import{a as j,L as A,c as E,n as o}from"./index-DhdOXyx3.js";import{B as b}from"./Button-B_cdY8XV.js";import{m as d,A as M}from"./animation-vendor-DKvKsx_2.js";const R=async n=>j.post("/auth/verify-invite",{token:n}),W=async(n,t)=>j.post("/auth/accept-invite",{token:n,password:t});function H(){var f,g;const[n]=I(),t=n.get("token"),v=L(),[r,N]=a.useState(null),[w,x]=a.useState(!0),[l,p]=a.useState(!1),[u,h]=a.useState(null),[c,k]=a.useState(""),[y,S]=a.useState("");a.useEffect(()=>{if(!t){h("Missing invitation token."),x(!1);return}(async()=>{try{const s=await R(t);N(s)}catch(s){const m=s instanceof E?s.message:"The invitation link is invalid or has expired.";h(m)}finally{x(!1)}})()},[t]);const P=async i=>{if(i.preventDefault(),c!==y){o.error("Passwords do not match");return}if(c.length<8){o.error("Password must be at least 8 characters long");return}p(!0);try{if(!t){o.error("Missing invitation token");return}await W(t,c),o.success("Invitation accepted! You can now log in."),v("/staff-login",{replace:!0})}catch(s){const m=s instanceof Error?s.message:"Failed to accept invitation";o.error(m),p(!1)}};return e.jsx(A,{children:e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center py-20 px-4 bg-gray-50/50",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl shadow-gray-200/50 overflow-hidden border border-gray-100",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Join the WIRIA Team"}),e.jsx("p",{className:"text-primary-100 text-sm opacity-90",children:"Please set up your account password to continue."})]}),e.jsx("div",{className:"p-8",children:e.jsx(M,{mode:"wait",children:w?e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Verifying invitation..."})]},"loading"):u?e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Link Invalid"}),e.jsx("p",{className:"text-gray-500 mb-8",children:u}),e.jsx(C,{to:"/",children:e.jsx(b,{variant:"secondary",fullWidth:!0,children:"Return to Home"})})]},"error"):e.jsxs(d.form,{initial:{opacity:0},animate:{opacity:1},onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 text-primary-600 rounded-full flex items-center justify-center font-bold",children:(((f=r==null?void 0:r.firstName)==null?void 0:f[0])||((g=r==null?void 0:r.email)==null?void 0:g[0])||"U").toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),e.jsx("p",{className:"text-xs text-gray-500",children:r==null?void 0:r.email})]})]}),e.jsxs("div",{className:"mt-2 text-[10px] font-bold uppercase tracking-wider text-primary-600 bg-primary-50 inline-block px-2 py-0.5 rounded",children:["Role: ",r==null?void 0:r.role]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1.5",children:"New Password"}),e.jsx("input",{type:"password",required:!0,value:c,onChange:i=>k(i.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-gray-900 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all placeholder:text-gray-400",placeholder:"Minimum 8 characters",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1.5",children:"Confirm Password"}),e.jsx("input",{type:"password",required:!0,value:y,onChange:i=>S(i.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-gray-900 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all placeholder:text-gray-400",placeholder:"Re-enter password",disabled:l})]})]}),e.jsx(b,{type:"submit",fullWidth:!0,disabled:l,className:"h-12 text-base shadow-lg shadow-primary-500/25",children:l?"Setting up Account...":"Complete Invitation"})]},"form")})})]}),e.jsxs("p",{className:"text-center mt-8 text-sm text-gray-500",children:["Need help? Contact ",e.jsx("a",{href:"mailto:admin@wiria.org",className:"text-primary-600 font-bold hover:underline",children:"Support"})]})]})})})}export{H as default};
//# sourceMappingURL=AcceptInvitePage-DQh2Mp26.js.map
