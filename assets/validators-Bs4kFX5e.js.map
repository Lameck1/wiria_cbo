{"version":3,"file":"validators-Bs4kFX5e.js","sources":["../../src/shared/utils/validators.ts"],"sourcesContent":["import { z } from 'zod';\n\nimport { LIMITS } from '../constants/config';\n\n/**\n * Shared Validation Schemas\n * Reusable Zod schemas for consistent validation across the application.\n */\n\nexport const phoneSchema = z\n  .string()\n  .min(10, 'Phone number must be at least 10 characters')\n  .max(13, 'Phone number must be at most 13 characters')\n  .regex(/^(?:\\+254|0)[17]\\d{8}$/, 'Invalid Kenyan phone number format');\n\nexport const emailSchema = z\n  .string()\n  .email('Invalid email address')\n  .min(5, 'Email is too short')\n  .max(LIMITS.MAX_EMAIL_LENGTH, 'Email is too long');\n\n\n\n\n\n/**\n * Validation Result Type\n */\ninterface ValidationResult {\n  valid: boolean;\n  error?: string;\n}\n\n/**\n * Sanitizes input by removing HTML tags and trimming whitespace.\n * Preserves text content inside tags.\n */\nexport const sanitizeInput = (input: unknown): string => {\n  if (typeof input !== 'string') return '';\n  // Remove HTML tags but keep their content, remove stray angle brackets, then trim\n  return input\n    .replaceAll(/<script[^>]*>.*?<\\/script>/gi, '') // Remove script tags and content\n    .replaceAll(/<[^>]*>/g, '') // Remove remaining HTML tags but keep content\n    .replaceAll(/[<>]/g, '') // Remove stray angle brackets\n    .trim();\n};\n\n/**\n * Validates Kenyan phone numbers (format: 254XXXXXXXXX)\n */\nexport const validatePhone = (phone: string): ValidationResult => {\n  if (!phone || phone.trim() === '') {\n    return { valid: false, error: 'Phone number is required' };\n  }\n\n  // Remove spaces for validation\n  const cleaned = phone.replaceAll(/\\s/g, '');\n\n  // Must be 12 digits starting with 254\n  const phoneRegex = /^254[17]\\d{8}$/;\n  if (!phoneRegex.test(cleaned)) {\n    return { valid: false, error: 'Invalid phone number format. Use 254XXXXXXXXX' };\n  }\n\n  return { valid: true };\n};\n\n/**\n * Validates M-Pesa phone numbers (Safaricom only)\n * Safaricom prefixes: 0700-0719, 0720-0721 (0722+ is Airtel), 0740-0759, 0790-0799, 0110-0119\n * In 254 format: 254XXXXXXXXX\n */\nexport const validateMpesaPhone = (phone: string): ValidationResult => {\n  if (!phone || phone.trim() === '') {\n    return { valid: false, error: 'Phone number is required' };\n  }\n\n  const cleaned = phone.replaceAll(/\\s/g, '');\n\n  // Safaricom prefixes in 254 format:\n  // 25470[0-9] = 0700-0709, 25471[0-9] = 0710-0719 (Safaricom)\n  // 0722, 0723, 0733 etc are Airtel, not Safaricom\n  // 2547[4-5]X = 074X-075X (Safaricom)\n  // 25479X = 079X (Safaricom)\n  // 2541[0-1]X = 010X-011X (Safaricom)\n  const safaricomRegex = /^254(70|71|7[45]|79|1[01])\\d{7}$/;\n  if (!safaricomRegex.test(cleaned)) {\n    return { valid: false, error: 'Please use a valid Safaricom number for M-Pesa' };\n  }\n\n  return { valid: true };\n};\n\n/**\n * Validates email addresses\n */\nexport const validateEmail = (email: string): ValidationResult => {\n  if (!email || email.trim() === '') {\n    return { valid: false, error: 'Email is required' };\n  }\n\n  const result = emailSchema.safeParse(email);\n  if (!result.success) {\n    return { valid: false, error: result.error.errors[0]?.message ?? 'Invalid email' };\n  }\n\n  return { valid: true };\n};\n\n/**\n * Validates donation amounts\n */\nexport const validateAmount = (amount: number | string): ValidationResult => {\n  const numberAmount = typeof amount === 'string' ? Number.parseFloat(amount) : amount;\n\n  if (Number.isNaN(numberAmount)) {\n    return { valid: false, error: 'Please enter a valid amount' };\n  }\n\n  if (numberAmount < LIMITS.MIN_DONATION) {\n    return { valid: false, error: `Minimum donation amount is KES ${LIMITS.MIN_DONATION}` };\n  }\n\n  if (numberAmount > LIMITS.MAX_DONATION) {\n    return {\n      valid: false,\n      error: `Maximum donation amount is KES ${LIMITS.MAX_DONATION.toLocaleString()}`,\n    };\n  }\n\n  return { valid: true };\n};\n\n/**\n * Validates that a field is not empty\n */\nexport const validateRequired = (value: unknown, fieldName = 'Field'): ValidationResult => {\n  if (value === undefined || value === null || (typeof value === 'string' && value.trim() === '')) {\n    return { valid: false, error: `${fieldName} is required` };\n  }\n  return { valid: true };\n};\n\n\n"],"names":["phoneSchema","z.string","emailSchema","LIMITS"],"mappings":"gFASO,MAAMA,EAAcC,EACxB,EACA,IAAI,GAAI,6CAA6C,EACrD,IAAI,GAAI,4CAA4C,EACpD,MAAM,yBAA0B,oCAAoC,EAE1DC,EAAcD,EACxB,EACA,MAAM,uBAAuB,EAC7B,IAAI,EAAG,oBAAoB,EAC3B,IAAIE,EAAO,iBAAkB,mBAAmB"}