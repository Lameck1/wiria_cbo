import{j as e}from"./query-vendor-CM55eWOT.js";import{h as I,c as C,r as a,L}from"./react-vendor-CXp26_Hx.js";import{B as b}from"./Button-JX_3oChN.js";import{d as j,k as A,n}from"./index-Ck6qqv4n.js";import{m as d,A as E}from"./animation-vendor-Bcu85ETC.js";const M=async o=>j.post("/auth/verify-invite",{token:o}),R=async(o,s)=>j.post("/auth/accept-invite",{token:o,password:s});function U(){var f,g;const[o]=I(),s=o.get("token"),w=C(),[r,v]=a.useState(null),[N,p]=a.useState(!0),[l,x]=a.useState(!1),[u,h]=a.useState(null),[c,k]=a.useState(""),[y,P]=a.useState("");a.useEffect(()=>{if(!s){h("Missing invitation token."),p(!1);return}(async()=>{try{const t=await M(s);v(t)}catch(t){const m=t instanceof A?t.message:"The invitation link is invalid or has expired.";h(m)}finally{p(!1)}})()},[s]);const S=async i=>{if(i.preventDefault(),c!==y){n.error("Passwords do not match");return}if(c.length<8){n.error("Password must be at least 8 characters long");return}x(!0);try{if(!s){n.error("Missing invitation token");return}await R(s,c),n.success("Invitation accepted! You can now log in."),w("/staff-login",{replace:!0})}catch(t){const m=t instanceof Error?t.message:"Failed to accept invitation";n.error(m),x(!1)}};return e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center bg-gray-50/50 px-4 py-20",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:[e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-gray-100 bg-white shadow-xl shadow-gray-200/50",children:[e.jsxs("div",{className:"from-primary-600 to-primary-700 bg-gradient-to-r p-8 text-center",children:[e.jsx("h1",{className:"mb-2 text-2xl font-bold text-white",children:"Join the WIRIA Team"}),e.jsx("p",{className:"text-primary-100 text-sm opacity-90",children:"Please set up your account password to continue."})]}),e.jsx("div",{className:"p-8",children:e.jsx(E,{mode:"wait",children:N?e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"border-primary-200 border-t-primary-600 mb-4 h-12 w-12 animate-spin rounded-full border-4"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Verifying invitation..."})]},"loading"):u?e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"py-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-red-50 text-red-500",children:e.jsx("svg",{className:"h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"mb-2 text-xl font-bold text-gray-900",children:"Link Invalid"}),e.jsx("p",{className:"mb-8 text-gray-500",children:u}),e.jsx(L,{to:"/",children:e.jsx(b,{variant:"secondary",fullWidth:!0,children:"Return to Home"})})]},"error"):e.jsxs(d.form,{initial:{opacity:0},animate:{opacity:1},onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"mb-6 rounded-2xl border border-gray-100 bg-gray-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary-100 text-primary-600 flex h-10 w-10 items-center justify-center rounded-full font-bold",children:(((f=r==null?void 0:r.firstName)==null?void 0:f[0])||((g=r==null?void 0:r.email)==null?void 0:g[0])||"U").toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),e.jsx("p",{className:"text-xs text-gray-500",children:r==null?void 0:r.email})]})]}),e.jsxs("div",{className:"text-primary-600 bg-primary-50 mt-2 inline-block rounded px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider",children:["Role: ",r==null?void 0:r.role]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",title:"New Password",className:"mb-1.5 block text-sm font-bold text-gray-700",children:"New Password"}),e.jsx("input",{id:"password",type:"password",required:!0,value:c,onChange:i=>k(i.target.value),className:"focus:ring-primary-500/20 focus:border-primary-500 w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-gray-900 outline-none transition-all placeholder:text-gray-400 focus:ring-2",placeholder:"Minimum 8 characters",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",title:"Confirm Password",className:"mb-1.5 block text-sm font-bold text-gray-700",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",type:"password",required:!0,value:y,onChange:i=>P(i.target.value),className:"focus:ring-primary-500/20 focus:border-primary-500 w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-gray-900 outline-none transition-all placeholder:text-gray-400 focus:ring-2",placeholder:"Re-enter password",disabled:l})]})]}),e.jsx(b,{type:"submit",fullWidth:!0,disabled:l,className:"shadow-primary-500/25 h-12 text-base shadow-lg",children:l?"Setting up Account...":"Complete Invitation"})]},"form")})})]}),e.jsxs("p",{className:"mt-8 text-center text-sm text-gray-500",children:["Need help? Contact"," ",e.jsx("a",{href:"mailto:admin@wiria.org",className:"text-primary-600 font-bold hover:underline",children:"Support"})]})]})})}export{U as default};
//# sourceMappingURL=AcceptInvitePage-Bn0fhpQG.js.map
