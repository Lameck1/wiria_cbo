{"version":3,"file":"LoginForm-C9RJqrUe.js","sources":["../../src/features/auth/hooks/useLogin.ts","../../src/features/auth/components/LoginForm.tsx"],"sourcesContent":["/**\n * useLogin Hook\n * Handles login flow with loading and error states\n */\n\nimport { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { notificationService } from '@/shared/services/notification/notificationService';\nimport { ApiError } from '@/shared/services/api/client';\nimport { UserRole } from '@/shared/types';\nimport { ROUTES } from '@/shared/constants/routes';\n\nexport function useLogin(isMember = false) {\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const { login } = useAuth();\n    const navigate = useNavigate();\n\n    const handleLogin = async (credentials: { identifier: string; password: string }) => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const loggedInUser = await login(credentials, isMember);\n\n            notificationService.success('Login successful!');\n\n            // Redirect based on role - Use fresh user data!\n            const role = loggedInUser.role;\n\n            if (role === UserRole.MEMBER) {\n                navigate(ROUTES.MEMBER_PORTAL, { replace: true });\n            } else if (\n                [UserRole.SUPER_ADMIN, UserRole.ADMIN, UserRole.STAFF].includes(role as UserRole)\n            ) {\n                navigate(ROUTES.ADMIN, { replace: true });\n            } else {\n                navigate(ROUTES.HOME, { replace: true });\n            }\n        } catch (err) {\n            const message =\n                err instanceof ApiError\n                    ? err.message || 'Invalid credentials'\n                    : 'Login failed. Please try again.';\n            setError(message);\n            notificationService.error(message);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    return {\n        handleLogin,\n        isLoading,\n        error,\n    };\n}\n","/**\n * LoginForm Component\n * Reusable login form for members and staff\n */\n\nimport { useState, FormEvent } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Button } from '@/shared/components/ui/Button';\nimport { Input } from '@/shared/components/ui/Input';\nimport { useLogin } from '../hooks/useLogin';\n\ninterface LoginFormProps {\n    isMember?: boolean;\n    title?: string;\n    subtitle?: string;\n}\n\nexport function LoginForm({ isMember = false, title, subtitle }: LoginFormProps) {\n    const [identifier, setIdentifier] = useState('');\n    const [password, setPassword] = useState('');\n    const { handleLogin, isLoading, error } = useLogin(isMember);\n\n    const onSubmit = async (e: FormEvent) => {\n        e.preventDefault();\n        await handleLogin({ identifier, password });\n    };\n\n    return (\n        <div className=\"w-full max-w-md\">\n            <div className=\"text-center mb-8\">\n                <h1 className=\"text-3xl font-bold text-wiria-blue-dark mb-2\">\n                    {title || (isMember ? 'Member Login' : 'Staff Login')}\n                </h1>\n                {subtitle && <p className=\"text-gray-600\">{subtitle}</p>}\n            </div>\n\n            <form onSubmit={onSubmit} className=\"space-y-6 bg-white p-8 rounded-lg shadow-lg\">\n                <Input\n                    type=\"text\"\n                    id=\"identifier\"\n                    label={isMember ? 'Email or Phone' : 'Username or Email'}\n                    value={identifier}\n                    onChange={(e) => setIdentifier(e.target.value)}\n                    required\n                    placeholder={isMember ? 'your@email.com or 0712345678' : 'username'}\n                    disabled={isLoading}\n                />\n\n                <Input\n                    type=\"password\"\n                    id=\"password\"\n                    label=\"Password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    required\n                    placeholder=\"Enter your password\"\n                    disabled={isLoading}\n                />\n\n                {error && (\n                    <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg\">\n                        <p className=\"text-sm text-red-800\">{error}</p>\n                    </div>\n                )}\n\n                <Button type=\"submit\" fullWidth isLoading={isLoading}>\n                    {isLoading ? 'Logging in...' : 'Login'}\n                </Button>\n\n                <div className=\"text-center space-y-2 text-sm\">\n                    <Link\n                        to=\"/reset-password\"\n                        className=\"block text-wiria-blue-dark hover:text-wiria-yellow transition-colors\"\n                    >\n                        Forgot password?\n                    </Link>\n                    {isMember && (\n                        <p className=\"text-gray-600\">\n                            Not a member?{' '}\n                            <Link to=\"/membership\" className=\"text-wiria-yellow hover:underline\">\n                                Register here\n                            </Link>\n                        </p>\n                    )}\n                </div>\n            </form>\n        </div>\n    );\n}\n"],"names":["useLogin","isMember","isLoading","setIsLoading","useState","error","setError","login","useAuth","navigate","useNavigate","credentials","loggedInUser","notificationService","role","UserRole","ROUTES","err","message","ApiError","LoginForm","title","subtitle","identifier","setIdentifier","password","setPassword","handleLogin","onSubmit","e","jsxs","jsx","Input","Button","Link"],"mappings":"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"}