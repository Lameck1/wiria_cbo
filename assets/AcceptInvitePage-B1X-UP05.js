import{a as i,j as e}from"./query-vendor-DeB3i2OK.js";import{d as k,u as I,L as S}from"./react-vendor-D3fc32Hw.js";import{b as v,A as C,n}from"./index-8OXY4Dao.js";import{B as j}from"./Button-DJTJFzQ2.js";import{m as d,A as L}from"./animation-vendor-JsFu8W7l.js";import"./helpers-CdcGZezW.js";const A=async r=>v.post("/auth/verify-invite",{token:r}),E=async(r,t)=>v.post("/auth/accept-invite",{token:r,password:t}),M=()=>e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"border-primary-200 border-t-primary-600 mb-4 h-12 w-12 animate-spin rounded-full border-4"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Verifying invitation..."})]},"loading"),R=({error:r})=>e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"py-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-red-50 text-red-500",children:e.jsx("svg",{className:"h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"mb-2 text-xl font-bold text-gray-900",children:"Link Invalid"}),e.jsx("p",{className:"mb-8 text-gray-500",children:r}),e.jsx(S,{to:"/",children:e.jsx(j,{variant:"secondary",fullWidth:!0,children:"Return to Home"})})]},"error"),F=({inviteData:r,password:t,setPassword:m,confirmPassword:p,setConfirmPassword:x,isSubmitting:o,onSubmit:l})=>e.jsxs(d.form,{initial:{opacity:0},animate:{opacity:1},onSubmit:s=>{l(s)},className:"space-y-6",children:[e.jsxs("div",{className:"mb-6 rounded-2xl border border-gray-100 bg-gray-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary-100 text-primary-600 flex h-10 w-10 items-center justify-center rounded-full font-bold",children:(r?.firstName?.[0]??r?.email?.[0]??"U").toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:[r?.firstName," ",r?.lastName]}),e.jsx("p",{className:"text-xs text-gray-500",children:r?.email})]})]}),e.jsxs("div",{className:"text-primary-600 bg-primary-50 mt-2 inline-block rounded px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider",children:["Role: ",r?.role]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",title:"New Password",className:"mb-1.5 block text-sm font-bold text-gray-700",children:"New Password"}),e.jsx("input",{id:"password",type:"password",required:!0,value:t,onChange:s=>m(s.target.value),className:"focus:ring-primary-500/20 focus:border-primary-500 w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-gray-900 outline-none transition-all placeholder:text-gray-400 focus:ring-2",placeholder:"Minimum 8 characters",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",title:"Confirm Password",className:"mb-1.5 block text-sm font-bold text-gray-700",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",type:"password",required:!0,value:p,onChange:s=>x(s.target.value),className:"focus:ring-primary-500/20 focus:border-primary-500 w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-gray-900 outline-none transition-all placeholder:text-gray-400 focus:ring-2",placeholder:"Re-enter password",disabled:o})]})]}),e.jsx(j,{type:"submit",fullWidth:!0,disabled:o,className:"shadow-primary-500/25 h-12 text-base shadow-lg",children:o?"Setting up Account...":"Complete Invitation"})]},"form");function H(){const[r]=k(),t=r.get("token"),m=I(),[p,x]=i.useState(null),[o,l]=i.useState(!0),[s,h]=i.useState(!1),[y,f]=i.useState(null),[c,w]=i.useState(""),[g,N]=i.useState("");i.useEffect(()=>{if(!t){f("Missing invitation token."),l(!1);return}(async()=>{try{const a=await A(t);x(a)}catch(a){const u=a instanceof C?a.message:"The invitation link is invalid or has expired.";f(u)}finally{l(!1)}})()},[t]);const P=async b=>{if(b.preventDefault(),c!==g){n.error("Passwords do not match");return}if(c.length<8){n.error("Password must be at least 8 characters long");return}h(!0);try{if(!t){n.error("Missing invitation token");return}await E(t,c),n.success("Invitation accepted! You can now log in."),m("/staff-login",{replace:!0})}catch(a){const u=a instanceof Error?a.message:"Failed to accept invitation";n.error(u),h(!1)}};return e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center bg-gray-50/50 px-4 py-20",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:[e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-gray-100 bg-white shadow-xl shadow-gray-200/50",children:[e.jsxs("div",{className:"from-primary-600 to-primary-700 bg-gradient-to-r p-8 text-center",children:[e.jsx("h1",{className:"mb-2 text-2xl font-bold text-white",children:"Join the WIRIA Team"}),e.jsx("p",{className:"text-primary-100 text-sm opacity-90",children:"Please set up your account password to continue."})]}),e.jsx("div",{className:"p-8",children:e.jsx(L,{mode:"wait",children:o?e.jsx(M,{}):y?e.jsx(R,{error:y}):e.jsx(F,{inviteData:p,password:c,setPassword:w,confirmPassword:g,setConfirmPassword:N,isSubmitting:s,onSubmit:P})})})]}),e.jsxs("p",{className:"mt-8 text-center text-sm text-gray-500",children:["Need help? Contact"," ",e.jsx("a",{href:"mailto:admin@wiria.org",className:"text-primary-600 font-bold hover:underline",children:"Support"})]})]})})}export{H as default};
//# sourceMappingURL=AcceptInvitePage-B1X-UP05.js.map
