import{j as r,u as p,b as M,c as N}from"./query-vendor-frBnvHSF.js";import{d as I,u as S,L as A,r as x}from"./react-vendor-BdaLayic.js";import{u as T,b as c}from"./index-ICA0O2oL.js";import{A as l}from"./endpoints-Cofiu-EW.js";const q=[{to:"/member-portal",label:"Dashboard",icon:"ðŸ ",exact:!0},{to:"/member-profile",label:"Profile",icon:"ðŸ‘¤"},{to:"/member-renewal",label:"Renewal",icon:"ðŸ”„"},{to:"/member-payments",label:"Payments",icon:"ðŸ’³"},{to:"/member-meetings",label:"Meetings",icon:"ðŸ“…"}];function _(){return r.jsx("nav",{className:"mb-6 overflow-x-auto rounded-xl bg-white shadow-md",children:r.jsx("div",{className:"flex",children:q.map(e=>r.jsxs(I,{to:e.to,end:e.exact,className:({isActive:t})=>`flex items-center gap-2 whitespace-nowrap border-b-2 px-5 py-4 text-sm font-semibold transition-colors ${t?"border-wiria-blue-dark bg-wiria-blue-dark/5 text-wiria-blue-dark":"border-transparent text-gray-600 hover:bg-gray-50 hover:text-wiria-blue-dark"}`,children:[r.jsx("span",{children:e.icon}),r.jsx("span",{children:e.label})]},e.to))})})}function re({children:e,title:t,subtitle:n,showNavigation:s=!0}){const{user:u,logout:m}=T(),i=S(),b=async()=>{await m(),i("/member-login")};return r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"sticky top-0 z-50 bg-white shadow-md",children:r.jsxs("nav",{className:"container mx-auto flex items-center justify-between px-4 py-4 lg:px-6",children:[r.jsxs(A,{to:"/member-portal",className:"flex items-center gap-2",children:[r.jsx("img",{src:"/images/Wiria_CBO_Logo_NEW_IV.png",alt:"WIRIA CBO",className:"h-10"}),r.jsx("span",{className:"hidden text-xl font-bold text-wiria-blue-dark sm:block",children:"WIRIA CBO"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(A,{to:"/",className:"text-sm font-semibold text-wiria-blue-dark transition-colors hover:text-wiria-yellow",children:"ðŸ  Home"}),u&&r.jsxs("span",{className:"hidden text-sm font-semibold text-gray-700 md:block",children:[u.firstName," ",u.lastName]}),r.jsx("button",{onClick:()=>{b()},className:"rounded-lg bg-gray-200 px-4 py-2 text-sm font-bold text-gray-700 transition-all hover:bg-gray-300",children:"Logout"})]})]})}),r.jsx("main",{className:"py-8",children:r.jsxs("div",{className:"container mx-auto px-4",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"mb-1 text-3xl font-bold text-wiria-blue-dark",children:t}),n&&r.jsx("p",{className:"text-gray-600",children:n})]}),s&&r.jsx(_,{}),e]})}),r.jsx("footer",{className:"mt-12 bg-wiria-blue-dark py-8 text-white",children:r.jsx("div",{className:"container mx-auto px-4 text-center",children:r.jsx("p",{children:"Â© 2025 WIRIA Community Based Organization. Confidential Member Portal."})})})]})}function h(e,t){if(Array.isArray(e))return e;for(const n of t){const s=e[n];if(Array.isArray(s))return s}return[]}function L(e){return{id:e.id??"",amount:Number(e.amount)??0,type:e.type??"DONATION",status:e.status??"PENDING",method:e.method??"MANUAL",mpesaReceiptNumber:e.mpesaReceiptNumber,createdAt:e.createdAt??""}}function k(e){return{id:e.id??"",title:e.title??"",description:e.description,date:e.date??"",time:e.time??"",location:e.location??"",type:e.type??"AGM",status:e.status??"UPCOMING",isRsvpd:e.isRsvpd,attendeesCount:e.attendeesCount}}function B(e){return{id:e.id??"",type:e.type??"",description:e.description??"",createdAt:e.timestamp??e.createdAt??""}}const y={profile(e){if(!e)throw new Error("Member adapter error: No profile data provided");const t=e.props??e;return{...Q(e,t),...F(t),...K(t),...O(e,t),...G(e,t)}},payments(e){return h(e,["payments"]).map(n=>L(n))},meetings(e){return h(e,["data"]).map(n=>k(n))},activity(e){return h(e,["data"]).map(n=>B(n))}};function Q(e,t){return{id:e.id??t.id??"",memberNumber:e.memberNumber??t.memberNumber??"",firstName:t.firstName??"",lastName:t.lastName??""}}function F(e){return{email:e.email??"",phone:e.phone??"",nationalId:e.nationalId,occupation:e.occupation,address:e.address,county:e.county,subcounty:e.subcounty,ward:e.ward}}function K(e){return{interests:e.interests??[],skills:e.skills??[]}}function O(e,t){return{status:e.status??t.status??"PENDING",membershipType:e.membershipType??t.membershipType,groupName:e.groupName??t.groupName,currentMemberCount:e.currentMemberCount??t.currentMemberCount,maxMemberCountReached:e.maxMemberCountReached??t.maxMemberCountReached}}function G(e,t){return{joinedAt:e.joinDate??e.joinedAt??t.joinDate??t.joinedAt??"",membershipExpiresAt:e.expiryDate??e.membershipExpiresAt??t.expiryDate??t.membershipExpiresAt,createdAt:e.createdAt??t.createdAt??""}}const a={all:["member"],profile:()=>[...a.all,"profile"],payments:()=>[...a.all,"payments"],meetings:e=>[...a.all,"meetings",e],documents:()=>[...a.all,"documents"],activity:()=>[...a.all,"activity"]};function U(){return p({queryKey:a.profile(),queryFn:async()=>{const e=await c.get(l.MEMBERS_ME);return y.profile(e.data)},staleTime:1e3*60*5})}function V(){const e=M();return N({mutationFn:async t=>{const n=await c.put(l.MEMBERS_ME,t);return y.profile(n.data)},onSuccess:t=>{e.setQueryData(a.profile(),t)}})}function W(){return p({queryKey:a.payments(),queryFn:async()=>{const e=await c.get(l.MEMBERS_PAYMENTS);return y.payments(e.data)},staleTime:1e3*60*5})}function D(){return p({queryKey:a.meetings("joined"),queryFn:async()=>{const e=await c.get(l.MEMBERS_MEETINGS);return y.meetings(e.data)},staleTime:1e3*60*5})}function Y(){return p({queryKey:a.meetings("available"),queryFn:async()=>{const e=await c.get(l.MEMBERS_MEETINGS_AVAILABLE);return y.meetings(e.data)},staleTime:1e3*60*5})}function z(){return p({queryKey:a.documents(),queryFn:async()=>{var n;return(((n=(await c.get(l.MEMBERS_DOCUMENTS)).data)==null?void 0:n.documents)??[]).map(s=>({id:s.id??"",name:s.name??"",type:s.type??"",url:s.url??"",createdAt:s.createdAt??""}))},staleTime:1e3*60*10})}function $(){return p({queryKey:a.activity(),queryFn:async()=>{const e=await c.get(l.MEMBERS_ACTIVITY);return y.activity(e.data)},staleTime:1e3*60*2})}function H(){const e=M();return N({mutationFn:async t=>{const n=l.MEMBERS_MEETINGS_RSVP.replace(":id",t);return c.post(n,{})},onSuccess:()=>{e.invalidateQueries({queryKey:a.meetings("joined")}),e.invalidateQueries({queryKey:a.meetings("available")})}})}function J(){const e=M();return N({mutationFn:async t=>{const n=l.MEMBERS_MEETINGS_RSVP.replace(":id",t);return c.delete(n)},onSuccess:()=>{e.invalidateQueries({queryKey:a.meetings("joined")}),e.invalidateQueries({queryKey:a.meetings("available")})}})}function X(e,t,n){var f;const s=x.useMemo(()=>(t.data??[]).filter(o=>o.status==="COMPLETED").reduce((o,d)=>o+d.amount,0),[t.data]),u=x.useMemo(()=>(t.data??[]).filter(o=>o.status==="PENDING").length,[t.data]),m=x.useMemo(()=>(n.data??[]).filter(o=>o.status==="UPCOMING").length,[n.data]),i=x.useMemo(()=>{var d;const o=(d=e.data)==null?void 0:d.membershipExpiresAt;return o?Math.ceil((new Date(o).getTime()-Date.now())/(1e3*60*60*24)):null},[(f=e.data)==null?void 0:f.membershipExpiresAt]),b=i!==null&&i<=0,g=i!==null&&i>0&&i<=30;return{totalPayments:s,pendingPayments:u,upcomingMeetings:m,daysUntilExpiry:i,isExpired:b,isExpiringSoon:g}}function se(){var E,v;const e=U(),t=V(),n=W(),s=D(),u=Y(),m=z(),i=$(),b=H(),g=J(),{totalPayments:f,pendingPayments:o,upcomingMeetings:d,daysUntilExpiry:w,isExpired:j,isExpiringSoon:P}=X(e,n,s),R=e.isLoading||n.isLoading||s.isLoading||m.isLoading||i.isLoading,C=((E=e.error)==null?void 0:E.message)??((v=n.error)==null?void 0:v.message)??null;return{profile:e.data??null,payments:n.data??[],meetings:s.data??[],availableMeetings:u.data??[],documents:m.data??[],activity:i.data??[],isLoading:R,error:C,fetchProfile:e.refetch,updateProfile:t.mutateAsync,fetchPayments:n.refetch,fetchMeetings:s.refetch,fetchAvailableMeetings:u.refetch,rsvpToMeeting:b.mutateAsync,cancelRsvp:g.mutateAsync,fetchDocuments:m.refetch,fetchActivity:i.refetch,fetchAll:async()=>{await Promise.all([e.refetch(),n.refetch(),s.refetch(),m.refetch(),i.refetch()])},totalPayments:f,pendingPayments:o,upcomingMeetings:d,daysUntilExpiry:w,isExpired:j,isExpiringSoon:P}}export{re as P,se as u};
//# sourceMappingURL=useMemberData-P6dvgI-k.js.map
