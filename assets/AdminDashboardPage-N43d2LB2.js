import{j as e,a as h,f}from"./query-vendor-DeB3i2OK.js";import{a as M,b}from"./dateUtils-D0Bnoiug.js";import{b as v,l as C,U as j,T as y,u as S,R as n,E}from"./index-YnLEVKPI.js";import{e as w}from"./apiUtils-CDDJc0SC.js";import{u}from"./react-vendor-D3fc32Hw.js";import{S as g}from"./StatusBadge-YsC6pSWk.js";import"./animation-vendor-JsFu8W7l.js";function I(){return e.jsxs("div",{className:"animate-pulse rounded-2xl border-t-4 border-gray-200 bg-white p-6 shadow-lg",children:[e.jsx("div",{className:"mb-3 h-3 w-24 rounded bg-gray-200"}),e.jsx("div",{className:"h-8 w-16 rounded bg-gray-200"})]})}function R(){return e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsxs("div",{className:"animate-pulse rounded-lg bg-gray-50 p-3",children:[e.jsx("div",{className:"mb-2 h-4 w-3/4 rounded bg-gray-200"}),e.jsx("div",{className:"h-3 w-1/2 rounded bg-gray-200"})]},s))})}function T(){return e.jsxs("div",{className:"animate-pulse rounded-2xl bg-white p-6 shadow-xl",children:[e.jsx("div",{className:"mb-6 h-6 w-48 rounded bg-gray-200"}),e.jsx("div",{className:"h-64 rounded bg-gray-100"})]})}function c({title:s,value:t,subtitle:a,borderColor:l="border-blue-600",onClick:o,icon:i}){const r=!!o;return e.jsxs("div",{className:`rounded-2xl border-t-4 ${l} bg-white p-6 shadow-lg transition-shadow ${r?"cursor-pointer hover:shadow-xl":""}`,onClick:o,role:r?"button":void 0,tabIndex:r?0:void 0,onKeyDown:d=>{r&&(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),o())},"aria-label":r?`View ${s}`:void 0,children:[i&&e.jsx("div",{className:"mb-2 text-2xl",children:i}),e.jsx("p",{className:"mb-1 text-xs font-bold uppercase text-gray-500",children:s}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:t}),a&&e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:a})]})}function N({data:s,title:t,color:a="bg-blue-500",formatValue:l=i=>i.toString(),height:o=120}){if(s.length===0)return e.jsxs("div",{className:"rounded-xl bg-white p-4 shadow",children:[e.jsx("h3",{className:"mb-2 text-sm font-bold text-gray-700",children:t}),e.jsx("div",{className:"py-8 text-center text-gray-400",children:"No data available"})]});const i=Math.max(...s.map(r=>r.value),1);return e.jsxs("div",{className:"rounded-xl bg-white p-4 shadow",children:[e.jsx("h3",{className:"mb-4 text-sm font-bold text-gray-700",children:t}),e.jsx("div",{className:"flex items-end gap-2",style:{height:o},children:s.map((r,d)=>{const D=r.value/i*100;return e.jsxs("div",{className:"flex flex-1 flex-col items-center",children:[e.jsxs("div",{className:"flex w-full flex-col items-center justify-end",style:{height:o-30},children:[e.jsx("span",{className:"mb-1 text-xs font-semibold text-gray-600",children:l(r.value)}),e.jsx("div",{className:`w-full ${a} rounded-t transition-all duration-300`,style:{height:`${Math.max(D,5)}%`}})]}),e.jsx("span",{className:"mt-1 w-full truncate text-center text-xs text-gray-500",children:r.label??M(r.month)})]},r.month+"-"+d)})})]})}const _=s=>s>=1e3?`${(s/1e3).toFixed(0)}K`:s.toString();function k({donationData:s=[],memberData:t=[]}){return e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(N,{data:(s||[]).map(a=>({month:a.month,value:a.amount})),title:"ðŸ“ˆ Donations Trend (Last 6 Months)",color:"bg-green-500",formatValue:_}),e.jsx(N,{data:(t||[]).map(a=>({month:a.month,value:a.count})),title:"ðŸ‘¥ New Members (Last 6 Months)",color:"bg-blue-500"})]})}const A=h.createContext(void 0),$=async()=>{try{const s=await v.get("/admin/statistics"),t=w(s);if(!t)throw new Error("Missing dashboard statistics data");return{members:t.members,donations:t.donations,contacts:t.contacts,safeguarding:t.safeguarding,applications:t.applications,tenders:t.tenders,news:t.news,recentApplications:t.recentApplications??[],recentDonations:t.recentDonations??[],recentMessages:t.recentMessages??[]}}catch(s){throw C.error("Failed to fetch consolidated dashboard stats:",s),new Error("Failed to load dashboard statistics. Please refresh the page.")}},m={all:["admin","dashboard"],stats:()=>[...m.all,"stats"],trends:()=>[...m.all,"trends"]};function O(){return f({queryKey:m.stats(),queryFn:$,staleTime:y.QUERY_DEFAULT_STALE_TIME})}function F(){return f({queryKey:m.trends(),queryFn:async()=>{const s=await v.get("/admin/trends");return w(s)??{donations:[],members:[]}},staleTime:y.QUERY_DEFAULT_STALE_TIME})}const U=["members","users","safeguarding"];function L(s,t){return s?s===j.SUPER_ADMIN||s===j.ADMIN?!0:!U.includes(t):!1}function P(s){return`KES ${s.toLocaleString()}`}function B({children:s}){const{user:t}=S(),{data:a}=O(),{data:l}=F(),i={stats:a,trends:l,canAccessModule:r=>L(t?.role,r),userFirstName:t?.firstName??"Admin"};return e.jsx(A.Provider,{value:i,children:s})}function x(){const s=h.use(A);if(s===void 0)throw new Error("useDashboard must be used within a DashboardProvider");return s}const H=[{label:"Manage News",icon:"ðŸ“°",route:n.ADMIN_NEWS,hoverColor:"hover:bg-wiria-blue-dark"},{label:"Manage Tenders",icon:"ðŸ“œ",route:n.ADMIN_TENDERS,hoverColor:"hover:bg-wiria-yellow"},{label:"Review Applications",icon:"ðŸ’¼",route:`${n.ADMIN_HR}?tab=applications`,hoverColor:"hover:bg-green-500"},{label:"Reply to Messages",icon:"âœ‰ï¸",route:n.ADMIN_CONTACTS,hoverColor:"hover:bg-indigo-500"},{label:"Schedule Meeting",icon:"ðŸ“…",route:n.ADMIN_MEETINGS,hoverColor:"hover:bg-purple-500"},{label:"Manage Opportunities",icon:"ðŸ¤",route:`${n.ADMIN_HR}?tab=opportunities`,hoverColor:"hover:bg-teal-500"}];function Q({canAccessMembers:s}){const t=u();return e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold text-wiria-blue-dark",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[H.map(a=>e.jsxs("button",{onClick:()=>t(a.route),className:`flex w-full items-center rounded-xl bg-gray-50 p-3 text-left font-semibold transition-all ${a.hoverColor} hover:text-white`,children:[e.jsx("span",{className:"mr-3",children:a.icon})," ",a.label]},a.label)),s&&e.jsxs("button",{onClick:()=>t(n.ADMIN_MEMBERS),className:"flex w-full items-center rounded-xl bg-gray-50 p-3 text-left font-semibold transition-all hover:bg-blue-500 hover:text-white",children:[e.jsx("span",{className:"mr-3",children:"ðŸ‘¤"})," View Members"]})]})]})}function p({title:s,viewAllRoute:t,isLoading:a=!1,isEmpty:l,emptyMessage:o,children:i}){const r=u();return e.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-wiria-blue-dark",children:s}),e.jsx("button",{onClick:()=>r(t),className:"text-sm text-wiria-blue-dark hover:underline",children:"View All â†’"})]}),a?e.jsx(R,{}):l?e.jsx("p",{className:"py-4 text-center text-gray-500",children:o}):e.jsx("div",{className:"space-y-3",children:i})]})}function K({applications:s,isLoading:t=!1}){const a=u();return e.jsx(p,{title:"Recent Applications",viewAllRoute:`${n.ADMIN_HR}?tab=applications`,isLoading:t,isEmpty:s.length===0,emptyMessage:"No recent applications",children:s.map(l=>e.jsxs("button",{type:"button",onClick:()=>a(`${n.ADMIN_HR}?tab=applications&appId=${l.id}`),className:"flex w-full cursor-pointer items-center justify-between rounded-lg bg-gray-50 p-3 text-left transition-colors hover:bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.position})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(g,{status:l.status}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:b(l.date)})]})]},l.id))})}function W({donations:s,isLoading:t=!1}){return e.jsx(p,{title:"Recent Donations",viewAllRoute:n.ADMIN_DONATIONS,isLoading:t,isEmpty:s.length===0,emptyMessage:"No recent donations",children:s.map(a=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-gray-50 p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:a.donor}),e.jsx("p",{className:"text-sm font-bold text-green-600",children:P(a.amount)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(g,{status:a.status}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:b(a.date)})]})]},a.id))})}function G({messages:s,isLoading:t=!1}){return e.jsx(p,{title:"Recent Messages",viewAllRoute:n.ADMIN_CONTACTS,isLoading:t,isEmpty:s.length===0,emptyMessage:"No recent messages",children:s.map(a=>e.jsxs("div",{className:"rounded-lg bg-gray-50 p-3",children:[e.jsxs("div",{className:"mb-1 flex items-start justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.name}),e.jsx(g,{status:a.status})]}),e.jsx("p",{className:"truncate text-xs text-gray-500",children:a.subject}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:b(a.date)})]},a.id))})}function V({stats:s,isLoading:t=!1}){return e.jsxs("div",{className:"rounded-2xl bg-gradient-to-br from-wiria-blue-dark to-blue-900 p-6 text-white shadow-lg",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold",children:"Quick Stats"}),t?e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 w-3/4 rounded bg-white bg-opacity-20"}),e.jsx("div",{className:"h-4 w-1/2 rounded bg-white bg-opacity-20"}),e.jsx("div",{className:"h-4 w-2/3 rounded bg-white bg-opacity-20"})]}):s?e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Total Members"}),e.jsx("span",{className:"font-bold",children:s.members.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Total Applications"}),e.jsx("span",{className:"font-bold",children:s.applications.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Published News"}),e.jsx("span",{className:"font-bold",children:s.news.published})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Total Tenders"}),e.jsx("span",{className:"font-bold",children:s.tenders.total})]})]}):null]})}function q(){const s=u(),{stats:t,canAccessModule:a}=x();return e.jsxs("div",{className:"mb-8 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:[a("members")&&e.jsx(c,{title:"Active Members",value:t.members.active,subtitle:`${t.members.pending} pending`,borderColor:"border-blue-600",onClick:()=>s(n.ADMIN_MEMBERS)}),e.jsx(c,{title:"Applications",value:t.applications.pending,subtitle:`${t.applications.total} total`,borderColor:"border-yellow-500",onClick:()=>s(`${n.ADMIN_HR}?tab=applications`)}),e.jsx(c,{title:"Unread Messages",value:t.contacts.unread,subtitle:`${t.contacts.total} total`,borderColor:"border-indigo-500",onClick:()=>s(n.ADMIN_CONTACTS)}),a("safeguarding")&&e.jsx(c,{title:"Open Cases",value:t.safeguarding.open,subtitle:`${t.safeguarding.critical} critical`,borderColor:"border-red-500",onClick:()=>s(n.ADMIN_SAFEGUARDING)}),e.jsx(c,{title:"Active Tenders",value:t.tenders.open,subtitle:`${t.tenders.total} total`,borderColor:"border-green-500",onClick:()=>s(n.ADMIN_TENDERS)}),e.jsx(c,{title:"Published News",value:t.news.published,subtitle:`${t.news.total} total`,borderColor:"border-purple-500",onClick:()=>s(n.ADMIN_NEWS)})]})}function Y(){const{trends:s}=x();return e.jsx(k,{donationData:s.donations,memberData:s.members})}function z(){const{stats:s}=x();return e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsx(K,{applications:s.recentApplications||[]}),e.jsx(W,{donations:s.recentDonations||[]})]})}function J(){const{stats:s,canAccessModule:t}=x();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{canAccessMembers:t("members")}),e.jsx(G,{messages:s.recentMessages||[]}),e.jsx(V,{stats:s})]})}function X(){const{userFirstName:s}=x();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-wiria-blue-dark",children:"Dashboard Overview"}),e.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",s,". Here's what's happening at WIRIA CBO."]})]}),e.jsx(q,{}),e.jsx(Y,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[e.jsx(z,{}),e.jsx(J,{})]})]})}function le(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"Admin Dashboard | WIRIA CBO"}),e.jsx("meta",{name:"description",content:"Overview of WIRIA CBO administrative activities, statistics, and trends."}),e.jsx(E,{children:e.jsx(h.Suspense,{fallback:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-wiria-blue-dark",children:"Dashboard Overview"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]}),e.jsx("div",{className:"mb-8 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:Array.from({length:6}).map((s,t)=>e.jsx(I,{},t))}),e.jsx(T,{})]}),children:e.jsx(B,{children:e.jsx(X,{})})})})]})}export{le as default};
//# sourceMappingURL=AdminDashboardPage-N43d2LB2.js.map
