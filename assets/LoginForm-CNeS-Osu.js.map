{"version":3,"file":"LoginForm-CNeS-Osu.js","sources":["../../src/features/auth/hooks/useLogin.ts","../../src/features/auth/schemas/auth.schema.ts","../../src/features/auth/components/LoginForm.tsx"],"sourcesContent":["/**\n * useLogin Hook\n * Handles login flow with loading and error states\n */\n\nimport { useState } from 'react';\n\nimport { useNavigate } from 'react-router-dom';\n\nimport { ROUTES } from '@/shared/constants/routes';\nimport { ApiError } from '@/shared/services/api/client';\nimport { notificationService } from '@/shared/services/notification/notificationService';\nimport { UserRole } from '@/shared/types';\n\nimport { useAuth } from '../context/useAuth';\n\nexport function useLogin(isMember = false) {\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { login } = useAuth();\n  const navigate = useNavigate();\n\n  const handleLogin = async (credentials: { identifier: string; password: string }) => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const loggedInUser = await login(credentials, isMember);\n\n      notificationService.success('Login successful!');\n\n      // Redirect based on role - Use fresh user data!\n      const role = loggedInUser.role;\n\n      if (role === UserRole.MEMBER) {\n        navigate(ROUTES.MEMBER_PORTAL, { replace: true });\n      } else if (\n        [UserRole.SUPER_ADMIN, UserRole.ADMIN, UserRole.STAFF].includes(role as UserRole)\n      ) {\n        navigate(ROUTES.ADMIN, { replace: true });\n      } else {\n        navigate(ROUTES.HOME, { replace: true });\n      }\n    } catch (error_) {\n      const message =\n        error_ instanceof ApiError\n          ? error_.message || 'Invalid credentials'\n          : 'Login failed. Please try again.';\n      setError(message);\n      notificationService.error(message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return {\n    handleLogin,\n    isLoading,\n    error,\n  };\n}\n","import { z } from 'zod';\n\nexport const loginSchema = z.object({\n  identifier: z.string().min(3, 'Username, email or phone is required'),\n  password: z.string().min(6, 'Password must be at least 6 characters'),\n});\n\nexport type LoginData = z.infer<typeof loginSchema>;\n","/**\n * LoginForm Component (Refactored)\n * Uses the unified Form abstraction for boilerplate-free validation and state management.\n */\n\nimport { Link } from 'react-router-dom';\n\nimport { Button } from '@/shared/components/ui/Button';\nimport { Form, FormField } from '@/shared/components/ui/form';\n\nimport { useLogin } from '../hooks/useLogin';\nimport { loginSchema } from '../schemas/auth.schema';\n\nimport type { LoginData } from '../schemas/auth.schema';\n\ninterface LoginFormProps {\n  isMember?: boolean;\n  title?: string;\n  subtitle?: string;\n}\n\nexport function LoginForm({ isMember = false, title, subtitle }: LoginFormProps) {\n  const { handleLogin, isLoading, error: apiError } = useLogin(isMember);\n\n  const onSubmit = async (data: LoginData) => {\n    await handleLogin(data);\n  };\n\n  return (\n    <div className=\"w-full max-w-md\">\n      <div className=\"mb-8 text-center\">\n        <h1 className=\"mb-2 text-3xl font-bold text-wiria-blue-dark\">\n          {title ?? (isMember ? 'Member Login' : 'Staff Login')}\n        </h1>\n        {subtitle && <p className=\"text-gray-600\">{subtitle}</p>}\n      </div>\n\n      <Form\n        schema={loginSchema}\n        defaultValues={{ identifier: '', password: '' }}\n        onSubmit={onSubmit}\n        className=\"rounded-lg bg-white p-8 shadow-lg\"\n      >\n        {() => (\n          <>\n            <FormField\n              name=\"identifier\"\n              label={isMember ? 'Email or Phone' : 'Username or Email'}\n              placeholder={isMember ? 'your@email.com or 0712345678' : 'username'}\n              disabled={isLoading}\n            />\n\n            <FormField\n              name=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              placeholder=\"Enter your password\"\n              disabled={isLoading}\n            />\n\n            {apiError && (\n              <div className=\"rounded-lg border border-red-200 bg-red-50 p-3\">\n                <p className=\"text-sm text-red-800\">{apiError}</p>\n              </div>\n            )}\n\n            <Button type=\"submit\" fullWidth isLoading={isLoading}>\n              {isLoading ? 'Logging in...' : 'Login'}\n            </Button>\n\n            <div className=\"space-y-2 text-center text-sm\">\n              <Link\n                to=\"/reset-password\"\n                className=\"block text-wiria-blue-dark transition-colors hover:text-wiria-yellow\"\n              >\n                Forgot password?\n              </Link>\n              {isMember && (\n                <p className=\"text-gray-600\">\n                  Not a member?{' '}\n                  <Link to=\"/membership\" className=\"text-wiria-yellow hover:underline\">\n                    Register here\n                  </Link>\n                </p>\n              )}\n            </div>\n          </>\n        )}\n      </Form>\n    </div>\n  );\n}\n"],"names":["useLogin","isMember","isLoading","setIsLoading","useState","error","setError","login","useAuth","navigate","useNavigate","credentials","loggedInUser","notificationService","role","UserRole","ROUTES","error_","message","ApiError","loginSchema","z.object","z.string","LoginForm","title","subtitle","handleLogin","apiError","onSubmit","data","jsxs","jsx","Form","Fragment","FormField","Button","Link"],"mappings":"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"}