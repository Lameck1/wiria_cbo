import{j as r,u as y,b as h,c as f}from"./query-vendor-CM55eWOT.js";import{N as T,c as q,L as A,r as x}from"./react-vendor-CXp26_Hx.js";import{f as Q,d as o,A as c}from"./index-Ck6qqv4n.js";const _=[{to:"/member-portal",label:"Dashboard",icon:"ðŸ ",exact:!0},{to:"/member-profile",label:"Profile",icon:"ðŸ‘¤"},{to:"/member-renewal",label:"Renewal",icon:"ðŸ”„"},{to:"/member-payments",label:"Payments",icon:"ðŸ’³"},{to:"/member-meetings",label:"Meetings",icon:"ðŸ“…"}];function L(){return r.jsx("nav",{className:"mb-6 overflow-x-auto rounded-xl bg-white shadow-md",children:r.jsx("div",{className:"flex",children:_.map(e=>r.jsxs(T,{to:e.to,end:e.exact,className:({isActive:s})=>`flex items-center gap-2 whitespace-nowrap border-b-2 px-5 py-4 text-sm font-semibold transition-colors ${s?"border-wiria-blue-dark bg-wiria-blue-dark/5 text-wiria-blue-dark":"border-transparent text-gray-600 hover:bg-gray-50 hover:text-wiria-blue-dark"}`,children:[r.jsx("span",{children:e.icon}),r.jsx("span",{children:e.label})]},e.to))})})}function H({children:e,title:s,subtitle:t,showNavigation:a=!0}){const{user:l,logout:u}=Q(),m=q(),g=async()=>{await u(),m("/member-login")};return r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"sticky top-0 z-50 bg-white shadow-md",children:r.jsxs("nav",{className:"container mx-auto flex items-center justify-between px-4 py-4 lg:px-6",children:[r.jsxs(A,{to:"/member-portal",className:"flex items-center gap-2",children:[r.jsx("img",{src:"/images/Wiria_CBO_Logo_NEW_IV.png",alt:"WIRIA CBO",className:"h-10"}),r.jsx("span",{className:"hidden text-xl font-bold text-wiria-blue-dark sm:block",children:"WIRIA CBO"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(A,{to:"/",className:"text-sm font-semibold text-wiria-blue-dark transition-colors hover:text-wiria-yellow",children:"ðŸ  Home"}),l&&r.jsxs("span",{className:"hidden text-sm font-semibold text-gray-700 md:block",children:[l.firstName," ",l.lastName]}),r.jsx("button",{onClick:g,className:"rounded-lg bg-gray-200 px-4 py-2 text-sm font-bold text-gray-700 transition-all hover:bg-gray-300",children:"Logout"})]})]})}),r.jsx("main",{className:"py-8",children:r.jsxs("div",{className:"container mx-auto px-4",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"mb-1 text-3xl font-bold text-wiria-blue-dark",children:s}),t&&r.jsx("p",{className:"text-gray-600",children:t})]}),a&&r.jsx(L,{}),e]})}),r.jsx("footer",{className:"mt-12 bg-wiria-blue-dark py-8 text-white",children:r.jsx("div",{className:"container mx-auto px-4 text-center",children:r.jsx("p",{children:"Â© 2025 WIRIA Community Based Organization. Confidential Member Portal."})})})]})}const p={profile(e){if(!e)throw new Error("Member adapter error: No profile data provided");const s=e.props||e;return{id:e.id||s.id||"",memberNumber:e.memberNumber||s.memberNumber||"",firstName:s.firstName||"",lastName:s.lastName||"",email:s.email||"",phone:s.phone||"",nationalId:s.nationalId,occupation:s.occupation,address:s.address,county:s.county,subcounty:s.subcounty,ward:s.ward,interests:s.interests||[],skills:s.skills||[],status:e.status||s.status||"PENDING",membershipType:e.membershipType||s.membershipType,groupName:e.groupName||s.groupName,currentMemberCount:e.currentMemberCount||s.currentMemberCount,maxMemberCountReached:e.maxMemberCountReached||s.maxMemberCountReached,joinedAt:e.joinDate||e.joinedAt||s.joinDate||s.joinedAt||"",membershipExpiresAt:e.expiryDate||e.membershipExpiresAt||s.expiryDate||s.membershipExpiresAt,createdAt:e.createdAt||s.createdAt||""}},payments(e){return(Array.isArray(e)?e:(e==null?void 0:e.payments)||[]).map(t=>({id:t.id||"",amount:Number(t.amount)||0,type:t.type||"DONATION",status:t.status||"PENDING",method:t.method||"MANUAL",mpesaReceiptNumber:t.mpesaReceiptNumber,createdAt:t.createdAt||""}))},meetings(e){return(Array.isArray(e)?e:(e==null?void 0:e.data)||[]).map(t=>({id:t.id||"",title:t.title||"",description:t.description,date:t.date||"",time:t.time||"",location:t.location||"",type:t.type||"AGM",status:t.status||"UPCOMING",isRsvpd:t.isRsvpd,attendeesCount:t.attendeesCount}))},activity(e){return(Array.isArray(e)?e:(e==null?void 0:e.data)||[]).map(t=>({id:t.id||"",type:t.type||"",description:t.description||"",createdAt:t.timestamp||t.createdAt||""}))}},n={all:["member"],profile:()=>[...n.all,"profile"],payments:()=>[...n.all,"payments"],meetings:e=>[...n.all,"meetings",e],documents:()=>[...n.all,"documents"],activity:()=>[...n.all,"activity"]};function k(){return y({queryKey:n.profile(),queryFn:async()=>{const e=await o.get(c.MEMBERS_ME);return p.profile(e.data)},staleTime:1e3*60*5})}function B(){const e=h();return f({mutationFn:async s=>{const t=await o.put(c.MEMBERS_ME,s);return p.profile(t.data)},onSuccess:s=>{e.setQueryData(n.profile(),s)}})}function K(){return y({queryKey:n.payments(),queryFn:async()=>{const e=await o.get(c.MEMBERS_PAYMENTS);return p.payments(e.data)},staleTime:1e3*60*5})}function O(){return y({queryKey:n.meetings("joined"),queryFn:async()=>{const e=await o.get(c.MEMBERS_MEETINGS);return p.meetings(e.data)},staleTime:1e3*60*5})}function G(){return y({queryKey:n.meetings("available"),queryFn:async()=>{const e=await o.get(c.MEMBERS_MEETINGS_AVAILABLE);return p.meetings(e.data)},staleTime:1e3*60*5})}function F(){return y({queryKey:n.documents(),queryFn:async()=>{var t;return(((t=(await o.get(c.MEMBERS_DOCUMENTS)).data)==null?void 0:t.documents)||[]).map(a=>({id:a.id||"",name:a.name||"",type:a.type||"",url:a.url||"",createdAt:a.createdAt||""}))},staleTime:1e3*60*10})}function U(){return y({queryKey:n.activity(),queryFn:async()=>{const e=await o.get(c.MEMBERS_ACTIVITY);return p.activity(e.data)},staleTime:1e3*60*2})}function V(){const e=h();return f({mutationFn:async s=>{const t=c.MEMBERS_MEETINGS_RSVP.replace(":id",s);return o.post(t,{})},onSuccess:()=>{e.invalidateQueries({queryKey:n.meetings("joined")}),e.invalidateQueries({queryKey:n.meetings("available")})}})}function W(){const e=h();return f({mutationFn:async s=>{const t=c.MEMBERS_MEETINGS_RSVP.replace(":id",s);return o.delete(t)},onSuccess:()=>{e.invalidateQueries({queryKey:n.meetings("joined")}),e.invalidateQueries({queryKey:n.meetings("available")})}})}function J(){var M,N,E;const e=k(),s=B(),t=K(),a=O(),l=G(),u=F(),m=U(),g=V(),v=W(),w=e.isLoading||t.isLoading||a.isLoading||u.isLoading||m.isLoading,j=((M=e.error)==null?void 0:M.message)||((N=t.error)==null?void 0:N.message)||null,R=x.useMemo(()=>(t.data||[]).filter(i=>i.status==="COMPLETED").reduce((i,b)=>i+b.amount,0),[t.data]),P=x.useMemo(()=>(t.data||[]).filter(i=>i.status==="PENDING").length,[t.data]),C=x.useMemo(()=>(a.data||[]).filter(i=>i.status==="UPCOMING").length,[a.data]),d=x.useMemo(()=>{var b;const i=(b=e.data)==null?void 0:b.membershipExpiresAt;return i?Math.ceil((new Date(i).getTime()-Date.now())/(1e3*60*60*24)):null},[(E=e.data)==null?void 0:E.membershipExpiresAt]),I=d!==null&&d<=0,S=d!==null&&d>0&&d<=30;return{profile:e.data||null,payments:t.data||[],meetings:a.data||[],availableMeetings:l.data||[],documents:u.data||[],activity:m.data||[],isLoading:w,error:j,fetchProfile:e.refetch,updateProfile:s.mutateAsync,fetchPayments:t.refetch,fetchMeetings:a.refetch,fetchAvailableMeetings:l.refetch,rsvpToMeeting:g.mutateAsync,cancelRsvp:v.mutateAsync,fetchDocuments:u.refetch,fetchActivity:m.refetch,fetchAll:async()=>{await Promise.all([e.refetch(),t.refetch(),a.refetch(),u.refetch(),m.refetch()])},totalPayments:R,pendingPayments:P,upcomingMeetings:C,daysUntilExpiry:d,isExpired:I,isExpiringSoon:S}}export{H as P,J as u};
//# sourceMappingURL=useMemberData-BdepG6Fx.js.map
