{"version":3,"file":"MemberRenewalPage-Ct9XY6d3.js","sources":["../../src/features/membership/hooks/useRenewal.ts","../../src/pages/MemberRenewalPage.tsx"],"sourcesContent":["/**\n * useRenewal Hook\n */\n\nimport { useState } from 'react';\nimport { apiClient } from '@/shared/services/api/client';\nimport { notificationService } from '@/shared/services/notification/notificationService';\nimport { API_ENDPOINTS } from '@/shared/services/api/endpoints';\n\nexport interface RenewalData {\n    paymentMethod: 'STK_PUSH' | 'MANUAL';\n    phoneNumber?: string;\n    transactionCode?: string;\n    memberCount?: number;\n    amount: number;\n}\n\nexport interface RenewalResponse {\n    success: boolean;\n    message: string;\n    checkoutRequestId?: string;\n    transactionId?: string;\n}\n\nexport function useRenewal() {\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const [paymentStatus, setPaymentStatus] = useState<\n        'PENDING' | 'SUCCESS' | 'FAILED' | null\n    >(null);\n    const [transactionId, setTransactionId] = useState<string | null>(null);\n\n    const submitRenewal = async (data: RenewalData) => {\n        setIsSubmitting(true);\n        setPaymentStatus(null);\n        setTransactionId(null);\n\n        try {\n            const response = await apiClient.post<RenewalResponse>(\n                API_ENDPOINTS.MEMBERS_RENEW,\n                data\n            );\n\n            const { checkoutRequestId, message } = response as RenewalResponse;\n\n            if (data.paymentMethod === 'STK_PUSH' && checkoutRequestId) {\n                setTransactionId(checkoutRequestId);\n                setPaymentStatus('PENDING');\n                notificationService.info('STK push sent to your phone. Please complete the payment.');\n            } else if (data.paymentMethod === 'MANUAL') {\n                setPaymentStatus('PENDING'); // Wait for admin verification\n                notificationService.success('Transaction submitted for verification.');\n            } else {\n                setPaymentStatus('SUCCESS');\n                notificationService.success(message || 'Renewal successful!');\n            }\n\n            return { success: true };\n        } catch (_error) {\n            notificationService.error('Renewal failed. Please try again.');\n            return { success: false };\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    const checkPaymentStatus = async (tid: string) => {\n        try {\n            const response = await apiClient.get<{ data: { status: string } }>(\n                `${API_ENDPOINTS.PAYMENTS_STATUS}/${tid}`\n            );\n\n            const { status } = response.data;\n            if (status === 'COMPLETED') {\n                setPaymentStatus('SUCCESS');\n                return 'SUCCESS';\n            } else if (status === 'FAILED') {\n                setPaymentStatus('FAILED');\n                return 'FAILED';\n            }\n            return 'PENDING';\n        } catch (_error) {\n            return 'PENDING';\n        }\n    };\n\n    return {\n        submitRenewal,\n        checkPaymentStatus,\n        isSubmitting,\n        paymentStatus,\n        transactionId,\n    };\n}\n","import { PortalLayout } from '@/features/membership/components/PortalLayout';\nimport { Card, CardBody } from '@/shared/components/ui/Card';\nimport { Button } from '@/shared/components/ui/Button';\nimport { Input } from '@/shared/components/ui/Input';\nimport { PaymentMethodToggle } from '@/features/donations/components/PaymentMethodToggle';\nimport { PaymentInstructions } from '@/features/donations/components/PaymentInstructions';\nimport { useAuth } from '@/features/auth/context/AuthContext';\nimport { useMemberData } from '@/features/membership/hooks/useMemberData';\nimport { useRenewal } from '@/features/membership/hooks/useRenewal';\nimport { usePaymentPoller } from '@/features/donations/hooks/usePaymentPoller';\nimport { useEffect, useState, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { formatPhoneNumber } from '@/shared/utils/helpers';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst INDIVIDUAL_SUB = 1000;\nconst INDIVIDUAL_REG = 500;\nconst GROUP_SUB = 500;\nconst GROUP_REG = 250;\n\nfunction MemberRenewalPage() {\n    const navigate = useNavigate();\n    useAuth();\n    const { profile, fetchProfile, daysUntilExpiry } = useMemberData();\n\n    const isGroup = profile?.membershipType === 'GROUP';\n\n    const [memberCount, setMemberCount] = useState(1);\n    const [phone, setPhone] = useState('');\n    const [paymentMethod, setPaymentMethod] = useState<'STK_PUSH' | 'MANUAL'>('STK_PUSH');\n    const [transactionCode, setTransactionCode] = useState('');\n    const [consentDataProtection, setConsentDataProtection] = useState(false);\n    const [consentCodeOfEthics, setConsentCodeOfEthics] = useState(false);\n\n    useEffect(() => {\n        fetchProfile();\n    }, [fetchProfile]);\n\n    useEffect(() => {\n        if (profile) {\n            setMemberCount(profile.currentMemberCount || 1);\n            setPhone(profile.phone || '');\n        }\n    }, [profile]);\n\n    const {\n        submitRenewal,\n        checkPaymentStatus,\n        isSubmitting,\n        paymentStatus,\n        transactionId,\n    } = useRenewal();\n\n    usePaymentPoller({\n        donationId: transactionId,\n        isActive: !!transactionId && paymentStatus === 'PENDING',\n        onStatusCheck: checkPaymentStatus,\n    });\n\n    const maxCount = profile?.maxMemberCountReached || profile?.currentMemberCount || 0;\n\n    const feeBreakdown = useMemo(() => {\n        const subRate = isGroup ? GROUP_SUB : INDIVIDUAL_SUB;\n        const regRate = isGroup ? GROUP_REG : INDIVIDUAL_REG;\n\n        const renewalCount = isGroup ? memberCount : 1;\n        const newRegCount = isGroup ? Math.max(0, memberCount - maxCount) : 0;\n\n        const renewalTotal = renewalCount * subRate;\n        const regTotal = newRegCount * regRate;\n\n        return {\n            renewal: { count: renewalCount, rate: subRate, subtotal: renewalTotal },\n            newRegistration: { count: newRegCount, rate: regRate, subtotal: regTotal },\n            total: renewalTotal + regTotal\n        };\n    }, [memberCount, maxCount, isGroup]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        await submitRenewal({\n            paymentMethod,\n            phoneNumber: formatPhoneNumber(phone),\n            transactionCode: paymentMethod === 'MANUAL' ? transactionCode : undefined,\n            memberCount: isGroup ? memberCount : undefined,\n            amount: feeBreakdown.total,\n        });\n    };\n\n    if (paymentStatus === 'SUCCESS') {\n        return (\n            <PortalLayout title=\"Renewal Successful\">\n                <div className=\"max-w-2xl mx-auto py-12\">\n                    <Card className=\"text-center p-12 border-none shadow-2xl bg-gradient-to-b from-white to-blue-50/30\">\n                        <CardBody>\n                            <div className=\"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-8 shadow-inner\">\n                                <svg className=\"w-12 h-12 text-green-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" />\n                                </svg>\n                            </div>\n                            <h2 className=\"text-3xl font-bold text-gray-900 mb-4\">Renewal Complete!</h2>\n                            <p className=\"text-lg text-gray-600 mb-10 leading-relaxed\">\n                                Thank you for renewing your WIRIA membership. Your account has been updated successfully.\n                            </p>\n                            <Button size=\"lg\" className=\"px-12 h-14 text-lg shadow-lg\" onClick={() => navigate('/member-portal')}>\n                                Return to Dashboard\n                            </Button>\n                        </CardBody>\n                    </Card>\n                </div>\n            </PortalLayout>\n        );\n    }\n\n    return (\n        <PortalLayout title=\"Renew Membership\">\n            <div className=\"max-w-4xl mx-auto px-4 py-8\">\n                <AnimatePresence mode=\"wait\">\n                    {paymentStatus === 'PENDING' ? (\n                        <motion.div key=\"pending\" initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className=\"text-center py-16\">\n                            <Card className=\"max-w-md mx-auto p-12 border-none shadow-2xl\">\n                                <CardBody>\n                                    <div className=\"relative mb-10\">\n                                        <div className=\"w-24 h-24 border-4 border-blue-100 border-t-wiria-blue-dark rounded-full animate-spin mx-auto\" />\n                                        <div className=\"absolute inset-0 flex items-center justify-center text-wiria-blue-dark font-bold\">\n                                            {paymentMethod === 'STK_PUSH' ? 'SMS' : 'Wait'}\n                                        </div>\n                                    </div>\n                                    <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">Processing Renewal</h3>\n                                    <p className=\"text-gray-600 mb-8\">\n                                        {paymentMethod === 'STK_PUSH'\n                                            ? 'Please complete the payment on your phone by entering your M-Pesa PIN.'\n                                            : 'We are verifying your transaction. This may take a few moments.'}\n                                    </p>\n                                    <Button variant=\"outline\" fullWidth size=\"lg\" onClick={() => window.location.reload()} disabled={isSubmitting}>\n                                        Refresh Status\n                                    </Button>\n                                </CardBody>\n                            </Card>\n                        </motion.div>\n                    ) : (\n                        <motion.div key=\"form\" initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n                                <Card className=\"border-none shadow-md overflow-hidden\">\n                                    <div className=\"h-1 bg-wiria-blue-dark\" />\n                                    <CardBody>\n                                        <h3 className=\"text-sm font-bold text-gray-500 uppercase tracking-wider mb-4\">Membership Status</h3>\n                                        <div className=\"space-y-4\">\n                                            <div className=\"flex justify-between items-center\">\n                                                <span className=\"text-gray-600\">Member Type</span>\n                                                <span className=\"font-bold bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-xs\">\n                                                    {profile?.membershipType || 'INDIVIDUAL'}\n                                                </span>\n                                            </div>\n                                            <div className=\"flex justify-between items-center\">\n                                                <span className=\"text-gray-600\">Expires On</span>\n                                                <span className=\"font-bold text-gray-900\">\n                                                    {profile?.membershipExpiresAt\n                                                        ? new Date(profile.membershipExpiresAt).toLocaleDateString()\n                                                        : '--'}\n                                                </span>\n                                            </div>\n                                            <div className=\"flex justify-between items-center\">\n                                                <span className=\"text-gray-600\">Days Remaining</span>\n                                                <span className={`font-mono font-bold ${daysUntilExpiry && daysUntilExpiry <= 30 ? 'text-red-500' : 'text-green-600'}`}>\n                                                    {daysUntilExpiry ?? '--'}\n                                                </span>\n                                            </div>\n                                        </div>\n                                    </CardBody>\n                                </Card>\n\n                                <div className=\"bg-gradient-to-br from-wiria-blue-dark to-blue-900 text-white p-8 rounded-2xl shadow-xl flex flex-col justify-center relative overflow-hidden\">\n                                    <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -translate-x-1/2 -translate-y-1/2\" />\n                                    <p className=\"text-blue-100 text-sm font-bold uppercase tracking-widest mb-2\">Total Amount Due</p>\n                                    <p className=\"text-5xl font-bold mb-2\">KES {feeBreakdown.total.toLocaleString()}</p>\n                                    <p className=\"text-blue-200 text-xs italic\">Renewal for the next 12 months</p>\n                                </div>\n                            </div>\n\n                            <form onSubmit={handleSubmit} className=\"space-y-8\">\n                                <AnimatePresence>\n                                    {isGroup && (\n                                        <motion.div initial={{ height: 0, opacity: 0 }} animate={{ height: 'auto', opacity: 1 }} className=\"mb-6 overflow-hidden\">\n                                            <Card className=\"border-blue-100 bg-blue-50/30\">\n                                                <CardBody>\n                                                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n                                                        <div>\n                                                            <h3 className=\"text-lg font-bold text-blue-900 mb-1\">Group Member Count</h3>\n                                                            <p className=\"text-sm text-blue-700\">Update your group size to include new members.</p>\n                                                        </div>\n                                                        <div className=\"flex items-center gap-4\">\n                                                            <div className=\"text-right flex flex-col items-end\">\n                                                                <span className=\"text-xs text-gray-500 uppercase font-bold\">Last Recorded</span>\n                                                                <span className=\"text-xl font-mono font-bold text-gray-800\">{maxCount}</span>\n                                                            </div>\n                                                            <div className=\"w-px h-10 bg-blue-200\" />\n                                                            <div className=\"w-32\">\n                                                                <Input\n                                                                    type=\"number\"\n                                                                    min={1}\n                                                                    value={memberCount}\n                                                                    onChange={(e) => setMemberCount(Math.max(1, parseInt(e.target.value) || 0))}\n                                                                    className=\"text-center font-bold text-xl h-12\"\n                                                                />\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                </CardBody>\n                                            </Card>\n                                        </motion.div>\n                                    )}\n                                </AnimatePresence>\n\n                                <div className=\"mb-8\">\n                                    <Card className=\"bg-gray-50 border-gray-100 border-2\">\n                                        <CardBody>\n                                            <h3 className=\"text-sm font-bold text-gray-900 uppercase tracking-wider mb-6 flex items-center gap-2\">\n                                                <svg className=\"w-4 h-4 text-wiria-blue-dark\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n                                                </svg>\n                                                Fee Breakdown\n                                            </h3>\n\n                                            <div className=\"space-y-4\">\n                                                <div className=\"flex justify-between items-center py-2 border-b border-gray-200 border-dashed\">\n                                                    <div className=\"text-gray-600\">\n                                                        <span className=\"font-medium text-gray-900\">Subscription Renewal</span>\n                                                        <p className=\"text-xs text-gray-500\">\n                                                            {feeBreakdown.renewal.count} {feeBreakdown.renewal.count === 1 ? 'member' : 'members'} × KES {feeBreakdown.renewal.rate.toLocaleString()}\n                                                        </p>\n                                                    </div>\n                                                    <span className=\"font-semibold text-gray-900\">KES {feeBreakdown.renewal.subtotal.toLocaleString()}</span>\n                                                </div>\n\n                                                {feeBreakdown.newRegistration.count > 0 && (\n                                                    <div className=\"flex justify-between items-center py-2 border-b border-gray-200 border-dashed\">\n                                                        <div className=\"text-gray-600\">\n                                                            <span className=\"font-medium text-blue-700\">Incremental Registration</span>\n                                                            <p className=\"text-xs text-gray-500\">\n                                                                {feeBreakdown.newRegistration.count} new {feeBreakdown.newRegistration.count === 1 ? 'member' : 'members'} × KES {feeBreakdown.newRegistration.rate.toLocaleString()}\n                                                            </p>\n                                                        </div>\n                                                        <span className=\"font-bold text-blue-700\">KES {feeBreakdown.newRegistration.subtotal.toLocaleString()}</span>\n                                                    </div>\n                                                )}\n\n                                                <div className=\"flex justify-between items-center pt-2\">\n                                                    <span className=\"text-lg font-bold text-gray-900\">Total Due</span>\n                                                    <motion.span\n                                                        key={feeBreakdown.total}\n                                                        initial={{ scale: 1.1, color: '#1e40af' }}\n                                                        animate={{ scale: 1, color: '#1e3a8a' }}\n                                                        className=\"text-2xl font-bold text-wiria-blue-dark font-mono\"\n                                                    >\n                                                        KES {feeBreakdown.total.toLocaleString()}\n                                                    </motion.span>\n                                                </div>\n                                            </div>\n                                        </CardBody>\n                                    </Card>\n                                </div>\n\n                                <Card className=\"shadow-lg border-none\">\n                                    <CardBody className=\"p-8\">\n                                        <h2 className=\"text-2xl font-bold text-wiria-blue-dark mb-8\">Payment Details</h2>\n\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8\">\n                                            <div>\n                                                <label className=\"block text-sm font-bold text-gray-700 mb-3\">\n                                                    Payment Method\n                                                </label>\n                                                <PaymentMethodToggle\n                                                    selected={paymentMethod}\n                                                    onChange={setPaymentMethod}\n                                                    disabled={isSubmitting}\n                                                />\n                                            </div>\n\n                                            <div>\n                                                {paymentMethod === 'STK_PUSH' ? (\n                                                    <Input\n                                                        label=\"M-Pesa Phone Number\"\n                                                        type=\"tel\"\n                                                        value={phone}\n                                                        onChange={(e) => setPhone(e.target.value)}\n                                                        placeholder=\"254700000000\"\n                                                        helperText=\"You'll receive a prompt on your phone\"\n                                                        disabled={isSubmitting}\n                                                    />\n                                                ) : (\n                                                    <Input\n                                                        label=\"Transaction Code\"\n                                                        value={transactionCode}\n                                                        onChange={(e) => setTransactionCode(e.target.value)}\n                                                        placeholder=\"e.g. QWE123RTY\"\n                                                        required\n                                                        helperText=\"Enter the code from the M-Pesa SMS\"\n                                                        disabled={isSubmitting}\n                                                    />\n                                                )}\n                                            </div>\n                                        </div>\n\n                                        <div className=\"bg-gray-50 p-6 rounded-2xl mb-8\">\n                                            <PaymentInstructions\n                                                paymentMethod={paymentMethod}\n                                                amount={feeBreakdown.total}\n                                                submitLabel=\"Complete Renewal\"\n                                                accountNumber=\"MEMBERSHIP_RENEW\"\n                                            />\n                                        </div>\n\n                                        <div className=\"space-y-4 mb-8\">\n                                            <div className=\"flex items-start gap-3\">\n                                                <input\n                                                    type=\"checkbox\"\n                                                    id=\"consentDataProtection\"\n                                                    checked={consentDataProtection}\n                                                    onChange={(e) => setConsentDataProtection(e.target.checked)}\n                                                    disabled={isSubmitting}\n                                                    className=\"mt-1 w-5 h-5 rounded border-gray-300 text-wiria-blue-dark focus:ring-wiria-blue-dark\"\n                                                />\n                                                <label htmlFor=\"consentDataProtection\" className=\"text-sm text-gray-700 leading-tight\">\n                                                    I consent to the processing of my personal data under the Data Protection Policy.\n                                                    <span className=\"text-red-500 ml-1\">*</span>\n                                                </label>\n                                            </div>\n\n                                            <div className=\"flex items-start gap-3\">\n                                                <input\n                                                    type=\"checkbox\"\n                                                    id=\"consentCodeOfEthics\"\n                                                    checked={consentCodeOfEthics}\n                                                    onChange={(e) => setConsentCodeOfEthics(e.target.checked)}\n                                                    disabled={isSubmitting}\n                                                    className=\"mt-1 w-5 h-5 rounded border-gray-300 text-wiria-blue-dark focus:ring-wiria-blue-dark\"\n                                                />\n                                                <label htmlFor=\"consentCodeOfEthics\" className=\"text-sm text-gray-700 leading-tight\">\n                                                    I agree to abide by the WIRIA Code of Ethics and Conduct.\n                                                    <span className=\"text-red-500 ml-1\">*</span>\n                                                </label>\n                                            </div>\n                                        </div>\n\n                                        <Button\n                                            type=\"submit\"\n                                            fullWidth\n                                            size=\"lg\"\n                                            isLoading={isSubmitting}\n                                            disabled={\n                                                !consentDataProtection ||\n                                                !consentCodeOfEthics ||\n                                                (paymentMethod === 'MANUAL' && !transactionCode)\n                                            }\n                                            className=\"h-14 text-lg shadow-xl\"\n                                        >\n                                            Complete Renewal • KES {feeBreakdown.total.toLocaleString()}\n                                        </Button>\n                                    </CardBody>\n                                </Card>\n                            </form>\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n            </div>\n        </PortalLayout>\n    );\n}\n\nexport default MemberRenewalPage;\n"],"names":["useRenewal","isSubmitting","setIsSubmitting","useState","paymentStatus","setPaymentStatus","transactionId","setTransactionId","data","response","apiClient","API_ENDPOINTS","checkoutRequestId","message","notificationService","tid","status","INDIVIDUAL_SUB","INDIVIDUAL_REG","GROUP_SUB","GROUP_REG","MemberRenewalPage","navigate","useNavigate","useAuth","profile","fetchProfile","daysUntilExpiry","useMemberData","isGroup","memberCount","setMemberCount","phone","setPhone","paymentMethod","setPaymentMethod","transactionCode","setTransactionCode","consentDataProtection","setConsentDataProtection","consentCodeOfEthics","setConsentCodeOfEthics","useEffect","submitRenewal","checkPaymentStatus","usePaymentPoller","maxCount","feeBreakdown","useMemo","subRate","regRate","renewalCount","newRegCount","renewalTotal","regTotal","handleSubmit","e","formatPhoneNumber","jsx","PortalLayout","Card","CardBody","Button","AnimatePresence","motion","jsxs","Input","PaymentMethodToggle","PaymentInstructions"],"mappings":"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"}