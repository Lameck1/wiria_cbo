import{a as i,j as e}from"./query-vendor-DeB3i2OK.js";import{b as x,n as u}from"./index-YnLEVKPI.js";import{C as j}from"./ConfirmDialog-DcyEGIWl.js";import{F as v}from"./FormModal-Dn2Mmtft.js";import{B as U}from"./Button-jhyg_cfE.js";import{u as C}from"./useAdminData-DA4gw9n3.js";import{g as D}from"./apiUtils-CDDJc0SC.js";import"./react-vendor-D3fc32Hw.js";import"./animation-vendor-JsFu8W7l.js";import"./Modal-DSDFZpMT.js";import"./helpers-C-aBis0i.js";import"./Input-BK6NcICT.js";import"./Select-ViCfK5u5.js";import"./Textarea-CHdiKLHU.js";const E=async()=>x.get("/updates?limit=100&includeAll=true"),S=async l=>x.post("/updates",l),A=async(l,t)=>x.patch(`/updates/${l}`,t),L=async l=>x.delete(`/updates/${l}`);function J(){const[l,t]=i.useState(null),[c,o]=i.useState(!1),[r,a]=i.useState("ALL"),[n,p]=i.useState(null),{items:d,isLoading:b,refetch:g}=C(["admin-news-updates"],E),h=i.useCallback(s=>{p(s)},[]),y=async()=>{if(n)try{await L(n),u.success("Update deleted successfully"),g()}catch{u.error("Failed to delete update")}finally{p(null)}},N=i.useCallback(s=>{t(s),o(!0)},[]),m=r==="ALL"?d:d.filter(s=>s.status===r),f=d.filter(s=>s.status==="DRAFT").length;return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-wiria-blue-dark",children:"News & Updates Management"}),e.jsx(U,{onClick:()=>{t(null),o(!0)},children:"+ Post New Update"})]}),e.jsxs("div",{className:"mb-6 flex gap-2",children:[e.jsxs("button",{onClick:()=>a("ALL"),className:`rounded-lg px-4 py-2 font-semibold transition-colors ${r==="ALL"?"bg-wiria-blue-dark text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",d.length,")"]}),e.jsxs("button",{onClick:()=>a("PUBLISHED"),className:`rounded-lg px-4 py-2 font-semibold transition-colors ${r==="PUBLISHED"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Published (",d.filter(s=>s.status==="PUBLISHED").length,")"]}),e.jsxs("button",{onClick:()=>a("DRAFT"),className:`flex items-center gap-2 rounded-lg px-4 py-2 font-semibold transition-colors ${r==="DRAFT"?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Drafts",f>0&&e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-bold ${r==="DRAFT"?"bg-white text-yellow-600":"bg-yellow-100 text-yellow-700"}`,children:f})]})]}),b?e.jsx("div",{className:"py-12 text-center",children:"Loading..."}):e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[m&&Array.isArray(m)?m.map(s=>e.jsx(P,{update:s,onEdit:N,onDelete:w=>{h(w)}},s.id)):e.jsx("div",{className:"col-span-full text-red-500",children:"Error: Updates data is corrupted. Please refresh."}),m.length===0&&e.jsx("p",{className:"col-span-full py-12 text-center text-gray-500",children:r==="DRAFT"?"No draft updates. Create one by saving as Draft!":"No updates found."})]}),c&&e.jsx(k,{update:l,onClose:()=>o(!1),onSuccess:()=>{o(!1),g()}}),e.jsx(j,{isOpen:n!==null,title:"Delete Update",message:"Are you sure you want to delete this update?",confirmLabel:"Delete",onConfirm:()=>{y()},onCancel:()=>p(null)})]})}const P=i.memo(function({update:t,onEdit:c,onDelete:o}){return e.jsxs("div",{className:"flex h-full flex-col overflow-hidden rounded-xl border-t-4 border-wiria-yellow bg-white shadow-lg",children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.title,className:"h-32 w-full object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-32 w-full items-center justify-center bg-gray-100 text-gray-400",children:"No Image"}),e.jsxs("div",{className:"flex-grow p-5",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsx("span",{className:"rounded-full bg-blue-100 px-2 py-1 text-xs font-bold text-blue-700",children:t.category}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsx("h3",{className:"mb-2 line-clamp-2 text-lg font-bold text-wiria-blue-dark",children:t.title}),e.jsx("p",{className:"line-clamp-3 text-sm text-gray-600",children:t.excerpt??(t.fullContent?t.fullContent.slice(0,150)+"...":"No content available")}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`rounded px-2 py-1 text-xs font-bold ${t.status==="PUBLISHED"?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:t.status})})]}),e.jsxs("div",{className:"mt-auto flex justify-end gap-3 border-t bg-gray-50 p-4",children:[e.jsx("button",{onClick:()=>c(t),className:"text-sm font-bold text-wiria-blue-dark hover:underline",children:"Edit"}),e.jsx("button",{onClick:()=>o(t.id),className:"text-sm font-bold text-red-600 hover:underline",children:"Delete"})]})]})});function k({update:l,onClose:t,onSuccess:c}){const o=async a=>{try{const n={title:a.title,imageUrl:a.imageUrl,category:a.category,status:a.status,fullContent:a.fullContent,excerpt:a.excerpt};l?(await A(l.id,n),u.success("Update modified successfully")):(await S(n),u.success("Update created successfully")),c()}catch(n){throw u.error(D(n,"Operation failed")),n}},r=[{name:"title",label:"Title",type:"text",required:!0,placeholder:"e.g. New Community Program Launch"},{name:"imageUrl",label:"Image URL (Optional)",type:"text",placeholder:"https://..."},{name:"category",label:"Category",type:"select",required:!0,options:[{value:"GENERAL",label:"General"},{value:"EVENT",label:"Event"},{value:"ANNOUNCEMENT",label:"Announcement"},{value:"STORY",label:"Success Story"}]},{name:"status",label:"Status",type:"select",required:!0,options:[{value:"PUBLISHED",label:"Published"},{value:"DRAFT",label:"Draft"}]},{name:"fullContent",label:"Content",type:"textarea",required:!0,placeholder:"Describe the update in detail...",rows:8},{name:"excerpt",label:"Excerpt (Optional)",type:"textarea",placeholder:"Short summary...",rows:3}];return e.jsx(v,{isOpen:!0,onClose:t,onSubmit:o,title:l?"Edit Update":"Post New Update",fields:r,initialData:l?{...l}:void 0,submitLabel:"Save Post"})}export{J as default};
//# sourceMappingURL=NewsManagementPage-BbRvbE-z.js.map
