{"version":3,"file":"resources.api-R4KhCyJj.js","sources":["../../src/features/admin/api/resources.api.ts"],"sourcesContent":["import { apiClient as client } from '@/shared/services/api/client';\n\nexport interface Resource {\n  id: string;\n  title: string;\n  category: string;\n  fileType: string;\n  fileSize: string;\n  isPublic: boolean;\n  downloadUrl?: string | null;\n  description: string;\n  summary?: string;\n  keyPoints?: string[];\n  downloads: number;\n  createdAt: string;\n}\n\nexport interface CreateResourcePayload {\n  title: string;\n  category: string;\n  fileType: string;\n  fileSize: string;\n  isPublic: boolean;\n  downloadUrl?: string | null;\n  description: string;\n  summary?: string;\n  keyPoints?: string[];\n}\n\nexport const getAdminResources = async () => {\n  return client.get<{ data: Resource[] }>('/resources');\n};\n\nexport const createResource = async (data: CreateResourcePayload) => {\n  return client.post<Resource>('/resources', data);\n};\n\nexport const updateResource = async (id: string, data: Partial<CreateResourcePayload>) => {\n  return client.patch<Resource>(`/resources/${id}`, data);\n};\n\nexport const deleteResource = async (id: string) => {\n  return client.delete(`/resources/${id}`);\n};\n\nexport const uploadFile = async (file: File, folder: string = 'resources') => {\n  // Client-side validation\n  const maxSize = 10 * 1024 * 1024; // 10MB\n  if (file.size > maxSize) {\n    throw new Error(\n      `File size exceeds 10MB limit. Your file is ${(file.size / (1024 * 1024)).toFixed(2)}MB. Please choose a smaller file.`\n    );\n  }\n\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('folder', folder);\n\n  const token = localStorage.getItem('wiria_auth_token');\n\n  try {\n    const response = await fetch(\n      `${import.meta.env.VITE_API_BASE_URL || 'http://localhost:5001/api'}/uploads`,\n      {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      }\n    );\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => null);\n\n      // Handle specific error cases\n      if (response.status === 413 || errorData?.error?.message?.includes('too large')) {\n        throw new Error(\n          `File is too large. Maximum size is 10MB. Please compress your file or choose a smaller one.`\n        );\n      }\n\n      if (response.status === 401) {\n        throw new Error('Authentication failed. Please log in again.');\n      }\n\n      if (response.status === 403) {\n        throw new Error('You do not have permission to upload files.');\n      }\n\n      // Generic error with status\n      throw new Error(\n        errorData?.error?.message || `Upload failed (${response.status}). Please try again.`\n      );\n    }\n\n    return response.json();\n  } catch (error: unknown) {\n    const err = error as { message?: string; name?: string };\n    // Re-throw our custom errors\n    if (\n      err.message?.includes('10MB') ||\n      err.message?.includes('Authentication') ||\n      err.message?.includes('permission')\n    ) {\n      throw error;\n    }\n\n    // Network or other errors\n    if (err.name === 'TypeError' && err.message?.includes('fetch')) {\n      throw new Error('Network error. Please check your connection and try again.');\n    }\n\n    throw new Error(err.message || 'File upload failed. Please try again.');\n  }\n};\n"],"names":["getAdminResources","client","createResource","data","updateResource","id","deleteResource","uploadFile","file","folder","formData","token","response","errorData","_b","_a","_c","error","err","_d","_e","_f","_g"],"mappings":"wCA6BO,MAAMA,EAAoB,SACxBC,EAAO,IAA0B,YAAY,EAGzCC,EAAiB,MAAOC,GAC5BF,EAAO,KAAe,aAAcE,CAAI,EAGpCC,EAAiB,MAAOC,EAAYF,IACxCF,EAAO,MAAgB,cAAcI,CAAE,GAAIF,CAAI,EAG3CG,EAAiB,MAAOD,GAC5BJ,EAAO,OAAO,cAAcI,CAAE,EAAE,EAG5BE,EAAa,MAAOC,EAAYC,EAAiB,cAAgB,mBAG5E,GAAID,EAAK,KAAO,SACd,MAAM,IAAI,MACR,+CAA+CA,EAAK,MAAQ,KAAO,OAAO,QAAQ,CAAC,CAAC,mCAAA,EAIxF,MAAME,EAAW,IAAI,SACrBA,EAAS,OAAO,OAAQF,CAAI,EAC5BE,EAAS,OAAO,SAAUD,CAAM,EAEhC,MAAME,EAAQ,aAAa,QAAQ,kBAAkB,EAErD,GAAI,CACF,MAAMC,EAAW,MAAM,MACrB,oCACA,CACE,OAAQ,OACR,QAAS,CACP,cAAe,UAAUD,CAAK,EAAA,EAEhC,KAAMD,CAAA,CACR,EAGF,GAAI,CAACE,EAAS,GAAI,CAChB,MAAMC,EAAY,MAAMD,EAAS,OAAO,MAAM,IAAM,IAAI,EAGxD,MAAIA,EAAS,SAAW,MAAOE,GAAAC,EAAAF,GAAA,YAAAA,EAAW,QAAX,YAAAE,EAAkB,UAAlB,MAAAD,EAA2B,SAAS,aAC3D,IAAI,MACR,6FAAA,EAIAF,EAAS,SAAW,IAChB,IAAI,MAAM,6CAA6C,EAG3DA,EAAS,SAAW,IAChB,IAAI,MAAM,6CAA6C,EAIzD,IAAI,QACRI,EAAAH,GAAA,YAAAA,EAAW,QAAX,YAAAG,EAAkB,UAAW,kBAAkBJ,EAAS,MAAM,sBAAA,CAElE,CAEA,OAAOA,EAAS,KAAA,CAClB,OAASK,EAAgB,CACvB,MAAMC,EAAMD,EAEZ,MACEE,EAAAD,EAAI,UAAJ,MAAAC,EAAa,SAAS,UACtBC,EAAAF,EAAI,UAAJ,MAAAE,EAAa,SAAS,oBACtBC,EAAAH,EAAI,UAAJ,MAAAG,EAAa,SAAS,cAEhBJ,EAIJC,EAAI,OAAS,eAAeI,EAAAJ,EAAI,UAAJ,MAAAI,EAAa,SAAS,UAC9C,IAAI,MAAM,4DAA4D,EAGxE,IAAI,MAAMJ,EAAI,SAAW,uCAAuC,CACxE,CACF"}